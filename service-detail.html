<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è·¯çº¿è§„åˆ’æœåŠ¡ - æ…¢é‡è‡ªé©¾æ¸¸</title>
    <link rel="stylesheet" href="public/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        .service-header {
            background-color: var(--light-color);
            padding: 60px 5%;
            text-align: center;
        }
        
        .service-header i {
            font-size: 4rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .service-header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 15px;
        }
        
        .service-header p {
            max-width: 800px;
            margin: 0 auto 20px;
            color: var(--gray-color);
        }
        
        .service-tags {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 15px;
            margin-top: 20px;
        }
        
        .service-tags span {
            background-color: rgba(30, 95, 116, 0.1);
            color: var(--primary-color);
            padding: 8px 15px;
            border-radius: 50px;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .service-tags span i {
            font-size: 14px;
            margin-bottom: 0;
        }
        
        .service-section {
            padding: 60px 5%;
            max-width: 1200px;
            margin: 0 auto;
        }
        
        .service-section h2 {
            color: var(--primary-color);
            margin-bottom: 30px;
            font-size: 2rem;
        }
        
        /* åœ°å›¾æ¼”ç¤ºéƒ¨åˆ†æ–°å¢æ ·å¼ */
        .map-demo-section {
            background-color: #f8f9fa;
            border-radius: 12px;
            padding: 60px 5%;
        }
        
        .map-demo-container {
            display: flex;
            flex-direction: column;
            gap: 30px;
            margin-top: 30px;
        }
        
        .map-container {
            width: 100%;
            height: 450px;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            background-color: #f5f5f5;
            /* ç§»é™¤ä¼šå¹²æ‰°åœ°å›¾æ˜¾ç¤ºçš„èƒŒæ™¯å›¾ç‰‡ */
            /* background-image: url('public/images/map-demo.jpg'); */
            /* background-size: cover;
            background-position: center; */
            position: relative;
        }
        
        /* æ·»åŠ åŠ è½½ä¸­çš„æŒ‡ç¤ºå™¨ */
        .map-container::before {
            content: 'åŠ è½½åœ°å›¾ä¸­...';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
            font-size: 16px;
        }
        
        .map-controls {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
        }
        
        .map-control-group {
            flex: 1;
            min-width: 200px;
        }
        
        .map-control-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-color);
        }
        
        .map-control-group input,
        .map-control-group select {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 15px;
        }
        
        .plan-route-btn {
            margin-top: auto;
            align-self: flex-end;
            flex: 0 0 auto;
            min-width: 120px;
        }
        
        .route-info-panel {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            margin-top: 20px;
            padding: 20px;
        }
        
        .route-summary h3, .route-details h3 {
            color: #333;
            font-size: 18px;
            margin-bottom: 15px;
            border-bottom: 1px solid #eee;
            padding-bottom: 10px;
        }
        
        .route-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        
        .stat-item {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .stat-item i {
            color: #4a8cca;
            font-size: 16px;
            width: 20px;
        }
        
        .route-steps {
            max-height: 300px;
            overflow-y: auto;
            border: 1px solid #eee;
            border-radius: 4px;
            margin-bottom: 20px;
        }
        
        .route-step {
            display: flex;
            align-items: center;
            padding: 10px 15px;
            border-bottom: 1px solid #f0f0f0;
        }
        
        .route-step:last-child {
            border-bottom: none;
        }
        
        .route-step .step-number {
            background-color: #4a8cca;
            color: white;
            width: 24px;
            height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            margin-right: 15px;
            flex-shrink: 0;
        }
        
        .step-instruction {
            flex-grow: 1;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .route-actions {
            display: flex;
            gap: 15px;
            justify-content: flex-start;
        }
        
        .route-actions .btn {
            padding: 8px 16px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
            border: none;
        }
        
        .save-route-btn {
            background-color: #4a8cca;
            color: white;
        }
        
        .share-route-btn {
            background-color: #f8f9fa;
            color: #333;
            border: 1px solid #ddd !important;
        }
        
        .more-steps {
            text-align: center;
            color: #777;
            padding: 10px;
        }
        
        /* å“åº”å¼è°ƒæ•´ */
        @media (max-width: 768px) {
            .route-stats {
                grid-template-columns: 1fr;
            }
            
            .route-actions {
                flex-direction: column;
            }
        }
        
        .route-item {
            border: 1px solid #eee;
            border-radius: 8px;
            margin-bottom: 15px;
            overflow: hidden;
        }
        
        .route-item.active {
            border-color: var(--primary-color);
            box-shadow: 0 4px 12px rgba(30, 95, 116, 0.15);
        }
        
        .route-item-header {
            background-color: #f8f9fa;
            padding: 15px;
            border-bottom: 1px solid #eee;
        }
        
        .route-item.active .route-item-header {
            background-color: rgba(30, 95, 116, 0.1);
        }
        
        .route-item-header h4 {
            margin: 0 0 10px;
            color: var(--text-color);
            font-size: 16px;
            font-weight: 600;
        }
        
        .route-item.active .route-item-header h4 {
            color: var(--primary-color);
        }
        
        .route-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            font-size: 14px;
            color: var(--gray-color);
        }
        
        .route-meta span {
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .route-item-body {
            padding: 15px;
        }
        
        .route-item-body p {
            margin: 0 0 10px;
            color: var(--text-color);
        }
        
        .route-conditions {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }
        
        .condition {
            font-size: 13px;
            padding: 4px 10px;
            border-radius: 50px;
            display: flex;
            align-items: center;
            gap: 5px;
        }
        
        .condition.good {
            background-color: rgba(52, 168, 83, 0.1);
            color: #34A853;
        }
        
        .condition.warning {
            background-color: rgba(251, 188, 5, 0.1);
            color: #FBBC05;
        }
        
        .condition.danger {
            background-color: rgba(234, 67, 53, 0.1);
            color: #EA4335;
        }
        
        /* ç‰¹è‰²å¡ç‰‡å¢å¼ºæ ·å¼ */
        .feature-detail {
            margin-top: 15px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .feature-detail span {
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 8px;
            color: var(--gray-color);
        }
        
        .feature-detail span i {
            font-size: 14px;
            margin: 0;
            color: var(--primary-color);
        }
        
        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 30px;
            margin: 40px 0;
        }
        
        .feature-card {
            background-color: white;
            border-radius: 8px;
            padding: 30px;
            text-align: center;
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
        }
        
        .feature-card i {
            font-size: 2.5rem;
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .feature-card h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
        }
        
        .steps-container {
            margin-top: 40px;
        }
        
        .step {
            display: flex;
            margin-bottom: 30px;
            position: relative;
        }
        
        .step:not(:last-child)::after {
            content: '';
            position: absolute;
            top: 60px;
            left: 25px;
            height: calc(100% - 40px);
            width: 2px;
            background-color: var(--light-gray);
        }
        
        .faq-container {
            margin-top: 40px;
        }
        
        .faq-item {
            margin-bottom: 20px;
            border-bottom: 1px solid var(--light-gray);
            padding-bottom: 20px;
        }
        
        .faq-question {
            font-weight: 600;
            color: var(--primary-color);
            margin-bottom: 10px;
            cursor: pointer;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .faq-question i {
            transition: all 0.3s ease;
        }
        
        .faq-answer {
            display: none;
            color: var(--gray-color);
            padding: 10px 0;
        }
        
        .faq-item.active .faq-question i {
            transform: rotate(180deg);
        }
        
        .faq-item.active .faq-answer {
            display: block;
        }
        
        .cta-section {
            background-color: var(--light-color);
            padding: 60px 5%;
            text-align: center;
            margin-top: 60px;
        }
        
        .cta-content {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .cta-content h2 {
            color: var(--primary-color);
            margin-bottom: 20px;
        }
        
        .cta-buttons {
            display: flex;
            gap: 20px;
            justify-content: center;
            margin-top: 30px;
        }
        
        @media (max-width: 768px) {
            .feature-grid {
                grid-template-columns: 1fr;
            }
            
            .cta-buttons {
                flex-direction: column;
                gap: 10px;
            }
        }
        
        .route-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
            padding: 0 15px 15px;
        }
        
        .route-actions button {
            padding: 8px 15px;
            border-radius: 4px;
            font-weight: 500;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 5px;
            transition: all 0.3s ease;
        }
        
        .nav-btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .nav-btn:hover {
            background-color: #164959;
            transform: translateY(-2px);
        }
        
        .share-btn {
            background-color: transparent;
            color: var(--primary-color);
            border: 1px solid var(--primary-color);
        }
        
        .share-btn:hover {
            background-color: rgba(30, 95, 116, 0.1);
            transform: translateY(-2px);
        }
        
        /* éšè—è·¯çº¿é¡¹ï¼Œç›´åˆ°è§„åˆ’å®Œæˆ */
        .route-item {
            display: none;
        }
        
        .route-item.active {
            display: block;
        }
        
        .service-process {
            padding: 80px 0;
            background-color: var(--light-gray);
        }
        
        /* æœåŠ¡æ­¥éª¤æ ·å¼ */
        .step-number {
            min-width: 50px;
            height: 50px;
            background-color: var(--primary-color);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
            margin-right: 20px;
            position: relative;
            z-index: 1;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-content h3 {
            color: var(--primary-color);
            margin-bottom: 10px;
        }
    </style>
</head>
<body>
    <header>
        <nav class="navbar">
            <div class="logo">
                <h1>æ…¢é‡</h1>
                <p>æ¢ç´¢ä¸­å›½ä¸­è¥¿éƒ¨çš„è‡ªé©¾ä¹‹æ—…</p>
            </div>
            <ul class="nav-links">
                <li><a href="index.html">é¦–é¡µ</a></li>
                <li><a href="index.html#routes">è·¯çº¿æ¨è</a></li>
                <li><a href="index.html#destinations">ç›®çš„åœ°</a></li>
                <li><a href="index.html#services">æœåŠ¡æŒ‡å—</a></li>
                <li><a href="index.html#community">ç¤¾åŒº</a></li>
                <li><a href="index.html#about">å…³äºæˆ‘ä»¬</a></li>
            </ul>
            <div class="auth-buttons">
                <button class="login-btn">ç™»å½•</button>
                <button class="signup-btn">æ³¨å†Œ</button>
            </div>
        </nav>
    </header>

    <main>
        <!-- Service Header -->
        <section class="service-header">
            <i class="fas fa-map-marked-alt" id="service-icon"></i>
            <h1 id="service-title">æ™ºèƒ½è·¯çº¿è§„åˆ’</h1>
            <p id="service-description">åŸºäºé«˜å¾·åœ°å›¾APIï¼Œæ ¹æ®æ‚¨çš„å–œå¥½ã€æ—¶é—´å’Œå­£èŠ‚ï¼Œæ™ºèƒ½è§„åˆ’æœ€é€‚åˆçš„è‡ªé©¾è·¯çº¿ï¼ŒåŒ…å«å®æ—¶è·¯å†µå’Œè·¯çº¿åå¥½</p>
            <div class="service-tags">
                <span><i class="fas fa-check-circle"></i> å¤šç§è·¯çº¿å¯¹æ¯”</span>
                <span><i class="fas fa-check-circle"></i> å®æ—¶è·¯å†µæ›´æ–°</span>
                <span><i class="fas fa-check-circle"></i> ä¸ªæ€§åŒ–å®šåˆ¶</span>
                <span><i class="fas fa-check-circle"></i> AIä¼˜åŒ–ç®—æ³•</span>
            </div>
        </section>
        
        <!-- Map Demo Section (New) -->
        <section class="service-section map-demo-section" id="map-demo-section">
            <h2>å®æ—¶è·¯çº¿æ¼”ç¤º</h2>
            <p>ä½“éªŒæˆ‘ä»¬çš„æ™ºèƒ½è·¯çº¿è§„åˆ’åŠŸèƒ½ï¼ŒæŸ¥çœ‹çœŸå®è·¯å†µå’Œå¤šç§è·¯çº¿é€‰æ‹©</p>
            
            <div class="map-demo-container">
                <div class="map-container" id="route-planning-map"></div>
                <div class="map-controls">
                    <div class="map-control-group">
                        <label for="start-point">èµ·ç‚¹</label>
                        <input type="text" id="start-point" placeholder="è¾“å…¥èµ·ç‚¹ï¼Œå¦‚ï¼šæˆéƒ½å¸‚åŒº">
                    </div>
                    <div class="map-control-group">
                        <label for="end-point">ç»ˆç‚¹</label>
                        <input type="text" id="end-point" placeholder="è¾“å…¥ç»ˆç‚¹ï¼Œå¦‚ï¼šä¹å¯¨æ²Ÿ">
                    </div>
                    <div class="map-control-group">
                        <label for="route-type">è·¯çº¿ç±»å‹</label>
                        <select id="route-type">
                            <option value="fastest">æœ€å¿«è·¯çº¿</option>
                            <option value="shortest">æœ€çŸ­è·¯çº¿</option>
                            <option value="scenic">é£æ™¯ä¼˜å…ˆ</option>
                            <option value="economic">ç»æµè·¯çº¿</option>
                        </select>
                    </div>
                    <button class="primary-btn plan-route-btn">è§„åˆ’è·¯çº¿</button>
                </div>
                
                <!-- ç¤ºä¾‹è·¯çº¿å¿«é€Ÿé€‰æ‹© -->
                <div class="example-routes" style="margin: 15px 0; display: flex; flex-wrap: wrap; gap: 10px;">
                    <span style="font-weight: 600; margin-right: 10px;">ç¤ºä¾‹è·¯çº¿ï¼š</span>
                    <button class="example-route" data-from="æˆéƒ½" data-to="ä¹å¯¨æ²Ÿ" style="padding: 5px 10px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">æˆéƒ½ â†’ ä¹å¯¨æ²Ÿ</button>
                    <button class="example-route" data-from="æˆéƒ½" data-to="ç¨»åŸ" style="padding: 5px 10px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">æˆéƒ½ â†’ ç¨»åŸ</button>
                    <button class="example-route" data-from="æˆéƒ½" data-to="è¥¿å®‰" style="padding: 5px 10px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">æˆéƒ½ â†’ è¥¿å®‰</button>
                    <button class="example-route" data-from="ä¸Šæµ·" data-to="æ­å·" style="padding: 5px 10px; background: #f0f0f0; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;">ä¸Šæµ· â†’ æ­å·</button>
                </div>
                
                <div class="route-info-panel">
                    <div class="route-summary">
                        <div class="route-item active">
                            <div class="route-item-header">
                                <h4>æ¨èè·¯çº¿ 1</h4>
                                <div class="route-meta">
                                    <span><i class="fas fa-road"></i> 387 å…¬é‡Œ</span>
                                    <span><i class="fas fa-clock"></i> 5 å°æ—¶ 20 åˆ†é’Ÿ</span>
                                    <span><i class="fas fa-gas-pump"></i> çº¦ Â¥320 æ²¹è´¹</span>
                                </div>
                            </div>
                            <div class="route-item-body">
                                <p>ç»ç”±ï¼šæˆéƒ½ â†’ éƒ½æ±Ÿå ° â†’ æ±¶å· â†’ æ¾æ½˜ â†’ ä¹å¯¨æ²Ÿ</p>
                                <div class="route-conditions">
                                    <span class="condition good"><i class="fas fa-circle"></i> è·¯å†µè‰¯å¥½</span>
                                    <span class="condition warning"><i class="fas fa-circle"></i> æ¾æ½˜æ®µå°é›¨</span>
                                </div>
                            </div>
                        </div>
                        <div class="route-item">
                            <div class="route-item-header">
                                <h4>å¤‡é€‰è·¯çº¿ 2</h4>
                                <div class="route-meta">
                                    <span><i class="fas fa-road"></i> 412 å…¬é‡Œ</span>
                                    <span><i class="fas fa-clock"></i> 5 å°æ—¶ 50 åˆ†é’Ÿ</span>
                                    <span><i class="fas fa-gas-pump"></i> çº¦ Â¥340 æ²¹è´¹</span>
                                </div>
                            </div>
                            <div class="route-item-body">
                                <p>ç»ç”±ï¼šæˆéƒ½ â†’ å½­å· â†’ èŒ‚å¿ â†’ æ¾æ½˜ â†’ ä¹å¯¨æ²Ÿ</p>
                                <div class="route-conditions">
                                    <span class="condition good"><i class="fas fa-circle"></i> è·¯å†µè‰¯å¥½</span>
                                    <span class="condition good"><i class="fas fa-circle"></i> å¤šæ™¯ç‚¹ï¼Œé€‚åˆæ‘„å½±</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Features Section -->
        <section class="service-section">
            <h2>æœåŠ¡ç‰¹ç‚¹</h2>
            <p>æˆ‘ä»¬çš„è·¯çº¿è§„åˆ’æœåŠ¡è€ƒè™‘åˆ°æ—…è¡Œçš„å„ä¸ªæ–¹é¢ï¼Œä¸ºæ‚¨æä¾›å…¨é¢ã€ç»†è‡´çš„è§„åˆ’æ–¹æ¡ˆã€‚</p>
            
            <div class="feature-grid">
                <div class="feature-card">
                    <i class="fas fa-user-alt"></i>
                    <h3>ä¸ªæ€§åŒ–å®šåˆ¶</h3>
                    <p>æ ¹æ®æ‚¨çš„å…´è¶£ã€å–œå¥½ã€æ—¶é—´å’Œé¢„ç®—ï¼Œä¸ºæ‚¨é‡èº«å®šåˆ¶ä¸“å±è·¯çº¿ï¼Œæ»¡è¶³ä¸åŒéœ€æ±‚ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-road"></i>
                    <h3>æœ€ä¼˜è·¯çº¿</h3>
                    <p>åˆ©ç”¨å¤§æ•°æ®å’Œç®—æ³•ï¼Œç»“åˆå®æ—¶è·¯å†µï¼Œä¸ºæ‚¨è§„åˆ’æœ€ä¼˜è¡Œé©¶è·¯çº¿ï¼Œé¿å¼€æ‹¥å µå’Œå±é™©è·¯æ®µã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-clock"></i>
                    <h3>æ—¶é—´è§„åˆ’</h3>
                    <p>ç§‘å­¦å®‰æ’å‚è§‚æ—¶é—´ï¼Œåˆç†åˆ†é…æ¸¸è§ˆä¸ä¼‘æ¯æ—¶é—´ï¼Œè®©æ‚¨çš„æ—…ç¨‹æ›´åŠ èˆ’é€‚ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-camera"></i>
                    <h3>æ™¯ç‚¹æ¨è</h3>
                    <p>æ ¹æ®å­£èŠ‚å’Œå¤©æ°”ï¼Œæ¨èæœ€ä½³æ™¯ç‚¹å’Œè§‚æ™¯ä½ç½®ï¼Œæ•æ‰æ¯ä¸€å¤„å®Œç¾ç¬é—´ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-utensils"></i>
                    <h3>é¤é¥®ä½å®¿</h3>
                    <p>æ¨èæ²¿é€”ç‰¹è‰²é¤å…å’Œä¼˜è´¨ä½å®¿ï¼Œè®©æ‚¨å“å°åœ°é“ç¾é£Ÿï¼Œäº«å—èˆ’é€‚ä¼‘æ¯ã€‚</p>
                </div>
                <div class="feature-card">
                    <i class="fas fa-mobile-alt"></i>
                    <h3>æ‰‹æœºå¯¼èˆª</h3>
                    <p>å°†è§„åˆ’å¥½çš„è·¯çº¿å¯¼å…¥æ‰‹æœºå¯¼èˆªï¼Œéšæ—¶æŸ¥çœ‹å’Œè°ƒæ•´ï¼Œè½»æ¾å‡ºè¡Œã€‚</p>
                </div>
            </div>
        </section>
        
        <!-- How It Works Section -->
        <section class="service-section">
            <h2>æœåŠ¡æµç¨‹</h2>
            <p>æˆ‘ä»¬çš„è·¯çº¿è§„åˆ’æœåŠ¡æµç¨‹ç®€å•é€æ˜ï¼Œä¸ºæ‚¨æä¾›ä¾¿æ·çš„ä½“éªŒã€‚</p>
            
            <div class="steps-container">
                <div class="step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <h3>æäº¤éœ€æ±‚</h3>
                        <p>åœ¨æˆ‘ä»¬çš„å¹³å°ä¸Šå¡«å†™æ‚¨çš„æ—…è¡Œç›®çš„åœ°ã€æ—¶é—´ã€å…´è¶£çˆ±å¥½å’Œç‰¹æ®Šéœ€æ±‚ç­‰ä¿¡æ¯ã€‚æ‚¨å¯ä»¥é€šè¿‡åœ¨çº¿è¡¨å•æˆ–ä¸æˆ‘ä»¬çš„æ—…è¡Œé¡¾é—®ç›´æ¥æ²Ÿé€šæ¥æäº¤éœ€æ±‚ã€‚</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <h3>éœ€æ±‚è¯„ä¼°</h3>
                        <p>æˆ‘ä»¬çš„æ—…è¡Œä¸“å®¶å°†è¯„ä¼°æ‚¨çš„éœ€æ±‚ï¼Œå¹¶è€ƒè™‘å­£èŠ‚ã€å¤©æ°”ã€è·¯å†µç­‰å› ç´ ï¼Œç¡®å®šæœ€é€‚åˆæ‚¨çš„æ—…è¡Œæ—¶é—´å’Œè·¯çº¿ã€‚æˆ‘ä»¬ä¼šä¸æ‚¨æ²Ÿé€šï¼Œç¡®ä¿æˆ‘ä»¬ç†è§£æ‚¨çš„æœŸæœ›ã€‚</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <h3>è·¯çº¿è®¾è®¡</h3>
                        <p>æ ¹æ®æ‚¨çš„éœ€æ±‚å’Œæˆ‘ä»¬çš„ä¸“ä¸šçŸ¥è¯†ï¼Œè®¾è®¡è¯¦ç»†çš„è¡Œç¨‹è·¯çº¿ï¼ŒåŒ…æ‹¬æ¯å¤©çš„è¡Œé©¶è·¯çº¿ã€æ¸¸è§ˆæ™¯ç‚¹ã€æ¨èæ´»åŠ¨ã€ç”¨é¤å’Œä½å®¿å®‰æ’ç­‰ã€‚</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <h3>æ–¹æ¡ˆç¡®è®¤</h3>
                        <p>æˆ‘ä»¬ä¼šå°†åˆæ­¥æ–¹æ¡ˆå‘é€ç»™æ‚¨å®¡é˜…ï¼Œå¹¶æ ¹æ®æ‚¨çš„åé¦ˆè¿›è¡Œè°ƒæ•´å’Œå®Œå–„ï¼Œç›´åˆ°æ‚¨æ»¡æ„ä¸ºæ­¢ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼Œæ‚¨å¯ä»¥æå‡ºä»»ä½•ç–‘é—®æˆ–ä¿®æ”¹å»ºè®®ã€‚</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <h3>é¢„è®¢æœåŠ¡</h3>
                        <p>æ ¹æ®æ‚¨çš„è¦æ±‚ï¼Œæˆ‘ä»¬å¯ä»¥å¸®åŠ©æ‚¨é¢„è®¢æ²¿é€”çš„ä½å®¿ã€æ™¯ç‚¹é—¨ç¥¨å’Œç‰¹è‰²ä½“éªŒæ´»åŠ¨ï¼Œç¡®ä¿æ‚¨çš„æ—…è¡Œé¡ºåˆ©è¿›è¡Œã€‚</p>
                    </div>
                </div>
                <div class="step">
                    <div class="step-number">6</div>
                    <div class="step-content">
                        <h3>æ—…è¡Œæ”¯æŒ</h3>
                        <p>åœ¨æ‚¨çš„æ—…è¡ŒæœŸé—´ï¼Œæˆ‘ä»¬æä¾›24å°æ—¶åœ¨çº¿æ”¯æŒï¼Œéšæ—¶è§£ç­”æ‚¨çš„é—®é¢˜ï¼Œå¹¶æ ¹æ®å®æ—¶æƒ…å†µæä¾›å»ºè®®å’Œè°ƒæ•´æ–¹æ¡ˆã€‚</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- FAQ Section -->
        <section class="service-section">
            <h2>å¸¸è§é—®é¢˜</h2>
            <p>å…³äºè·¯çº¿è§„åˆ’æœåŠ¡çš„å¸¸è§é—®é¢˜è§£ç­”ï¼Œå¸®åŠ©æ‚¨æ›´å¥½åœ°äº†è§£æˆ‘ä»¬çš„æœåŠ¡ã€‚</p>
            
            <div class="faq-container">
                <div class="faq-item">
                    <div class="faq-question">
                        <span>è·¯çº¿è§„åˆ’æœåŠ¡éœ€è¦å¤šé•¿æ—¶é—´å®Œæˆï¼Ÿ</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸€ä¸ªå®Œæ•´çš„è·¯çº¿è§„åˆ’éœ€è¦3-5ä¸ªå·¥ä½œæ—¥å®Œæˆã€‚å¯¹äºå¤æ‚çš„é•¿é€”æ—…è¡Œæˆ–ç‰¹æ®Šéœ€æ±‚ï¼Œå¯èƒ½éœ€è¦æ›´é•¿æ—¶é—´ã€‚å¦‚æœæ‚¨æœ‰ç´§æ€¥éœ€æ±‚ï¼Œè¯·åœ¨æäº¤ç”³è¯·æ—¶è¯´æ˜ï¼Œæˆ‘ä»¬ä¼šå°½é‡ä¸ºæ‚¨åŠ å¿«è¿›åº¦ã€‚</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <span>è·¯çº¿è§„åˆ’æœåŠ¡æ”¶è´¹æ ‡å‡†æ˜¯æ€æ ·çš„ï¼Ÿ</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>æˆ‘ä»¬çš„åŸºç¡€è·¯çº¿è§„åˆ’æœåŠ¡èµ·ä»·ä¸ºÂ¥299ï¼Œå…·ä½“è´¹ç”¨å–å†³äºæ—…è¡Œå¤©æ•°ã€è·¯çº¿å¤æ‚åº¦å’Œæ˜¯å¦éœ€è¦é¢å¤–æœåŠ¡ï¼ˆå¦‚é¢„è®¢æœåŠ¡ã€ç´§æ€¥æ”¯æŒç­‰ï¼‰ã€‚æ‚¨å¯ä»¥é€šè¿‡æˆ‘ä»¬çš„åœ¨çº¿ä»·æ ¼è®¡ç®—å™¨è·å–ç²¾ç¡®æŠ¥ä»·ï¼Œæˆ–ç›´æ¥è”ç³»æˆ‘ä»¬çš„å®¢æœå›¢é˜Ÿå’¨è¯¢ã€‚</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <span>æˆ‘å¯ä»¥ä¿®æ”¹å·²ç»ç¡®è®¤çš„è·¯çº¿å—ï¼Ÿ</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>æ˜¯çš„ï¼Œæ‚¨å¯ä»¥åœ¨å‡ºå‘å‰éšæ—¶æå‡ºä¿®æ”¹éœ€æ±‚ã€‚é¦–æ¬¡ä¿®æ”¹æ˜¯å…è´¹çš„ï¼Œä¹‹åæ¯æ¬¡ä¿®æ”¹å¯èƒ½ä¼šæ”¶å–å°‘é‡æœåŠ¡è´¹ã€‚æˆ‘ä»¬ç†è§£æ—…è¡Œè®¡åˆ’å¯èƒ½ä¼šå› å„ç§åŸå› å˜æ›´ï¼Œæˆ‘ä»¬ä¼šå°½é‡æ»¡è¶³æ‚¨çš„ä¿®æ”¹éœ€æ±‚ã€‚</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <span>å¦‚æœæˆ‘å¯¹è§„åˆ’çš„è·¯çº¿ä¸æ»¡æ„æ€ä¹ˆåŠï¼Ÿ</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>æˆ‘ä»¬æä¾›æ»¡æ„ä¿éšœã€‚å¦‚æœæ‚¨å¯¹æˆ‘ä»¬æä¾›çš„æ–¹æ¡ˆä¸æ»¡æ„ï¼Œæˆ‘ä»¬ä¼šæ ¹æ®æ‚¨çš„åé¦ˆè¿›è¡Œè°ƒæ•´å’Œä¼˜åŒ–ï¼Œç›´åˆ°æ‚¨æ»¡æ„ä¸ºæ­¢ã€‚å¦‚æœç»è¿‡å¤šæ¬¡è°ƒæ•´åä»æ— æ³•æ»¡è¶³æ‚¨çš„æœŸæœ›ï¼Œæˆ‘ä»¬æä¾›å…¨é¢é€€æ¬¾æœåŠ¡ã€‚</p>
                    </div>
                </div>
                <div class="faq-item">
                    <div class="faq-question">
                        <span>è·¯çº¿è§„åˆ’åŒ…å«å“ªäº›å…·ä½“å†…å®¹ï¼Ÿ</span>
                        <i class="fas fa-chevron-down"></i>
                    </div>
                    <div class="faq-answer">
                        <p>æˆ‘ä»¬çš„è·¯çº¿è§„åˆ’åŒ…æ‹¬ï¼šè¯¦ç»†çš„æ¯æ—¥è¡Œç¨‹å®‰æ’ã€è¡Œé©¶è·¯çº¿æŒ‡å—ï¼ˆåŒ…æ‹¬è·¯å†µå’Œå¯¼èˆªä¿¡æ¯ï¼‰ã€æ¨èæ™¯ç‚¹å’Œæ´»åŠ¨ã€ç”¨é¤å’Œä½å®¿æ¨èã€å¿…è¦çš„äº¤é€šå’Œå®‰å…¨ä¿¡æ¯ã€å­£èŠ‚æ€§æç¤ºå’Œå»ºè®®ç­‰ã€‚æ‚¨å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©æ˜¯å¦åŒ…å«é¢„è®¢æœåŠ¡ã€‚</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- Testimonials -->
        <section class="service-section">
            <h2>ç”¨æˆ·è¯„ä»·</h2>
            <p>æ¥è‡ªå…¶ä»–è‡ªé©¾çˆ±å¥½è€…çš„çœŸå®è¯„ä»·ï¼Œåˆ†äº«ä»–ä»¬ä½¿ç”¨æˆ‘ä»¬çš„è·¯çº¿è§„åˆ’æœåŠ¡çš„ä½“éªŒã€‚</p>
            
            <div class="testimonials-slider">
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"æ…¢é‡çš„è·¯çº¿è§„åˆ’æœåŠ¡éå¸¸æ£’ï¼ä»–ä»¬ä¸ºæˆ‘ä»¬ç­–åˆ’çš„é’æµ·æ¹–-èŒ¶å¡ç›æ¹–è‡ªé©¾ä¹‹æ—…å®Œç¾å¹³è¡¡äº†é£æ™¯æ¬£èµå’Œä¼‘æ¯æ—¶é—´ï¼Œé¿å¼€äº†æ—…æ¸¸æ—ºå­£çš„æ‹¥å µè·¯æ®µï¼Œæ¨èçš„å½“åœ°ç‰¹è‰²é¤å…ä¹Ÿéå¸¸åœ°é“ã€‚"</p>
                    </div>
                    <div class="testimonial-author">
                        <img src="public/images/avatars/user1.jpg" alt="ç”¨æˆ·å¤´åƒ">
                        <div class="author-info">
                            <h4>å¼ å…ˆç”Ÿ</h4>
                            <p>åŒ—äº¬ | é’æµ·æ¹–è‡ªé©¾æ¸¸</p>
                        </div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"ä½œä¸ºä¸€ä¸ªæ‘„å½±çˆ±å¥½è€…ï¼Œæˆ‘å¾ˆæ„Ÿè°¢æ…¢é‡çš„è·¯çº¿è§„åˆ’å›¢é˜Ÿè€ƒè™‘åˆ°äº†æœ€ä½³çš„æ‹æ‘„æ—¶é—´å’Œè§’åº¦ã€‚ä»–ä»¬æ¨èçš„å‡ ä¸ªé²œä¸ºäººçŸ¥çš„è§‚æ™¯ç‚¹è®©æˆ‘æ‹åˆ°äº†ä»¤äººæƒŠå¹çš„ç…§ç‰‡ï¼Œç»å¯¹è¶…å‡ºäº†æˆ‘çš„æœŸæœ›ï¼"</p>
                    </div>
                    <div class="testimonial-author">
                        <img src="public/images/avatars/user2.jpg" alt="ç”¨æˆ·å¤´åƒ">
                        <div class="author-info">
                            <h4>æå¥³å£«</h4>
                            <p>ä¸Šæµ· | å·è¥¿é«˜åŸè‡ªé©¾æ¸¸</p>
                        </div>
                    </div>
                </div>
                <div class="testimonial-card">
                    <div class="testimonial-content">
                        <p>"å¸¦ç€ä¸¤ä¸ªå­©å­è‡ªé©¾æœ¬æ¥å¾ˆæ‹…å¿ƒï¼Œä½†æ…¢é‡çš„è·¯çº¿å®‰æ’éå¸¸äººæ€§åŒ–ï¼Œè€ƒè™‘åˆ°äº†å­©å­çš„éœ€æ±‚ï¼Œæ¯å¤©çš„è¡Œç¨‹ä¸ä¼šå¤ªèµ¶ï¼Œä¼‘æ¯ç‚¹ä¹Ÿéƒ½å¾ˆé€‚åˆå®¶åº­ã€‚å­©å­ä»¬ç©å¾—å¾ˆå¼€å¿ƒï¼Œæˆ‘ä»¬ä¹Ÿä¸ä¼šå¤ªç´¯ï¼ŒçœŸçš„å¾ˆæ„Ÿè°¢ï¼"</p>
                    </div>
                    <div class="testimonial-author">
                        <img src="public/images/avatars/user3.jpg" alt="ç”¨æˆ·å¤´åƒ">
                        <div class="author-info">
                            <h4>ç‹å…ˆç”Ÿ</h4>
                            <p>å¹¿å· | å¼ å®¶ç•Œè‡ªé©¾æ¸¸</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- CTA Section -->
        <section class="cta-section">
            <div class="cta-content">
                <h2>å‡†å¤‡å¼€å§‹æ‚¨çš„å®Œç¾è‡ªé©¾ä¹‹æ—…ï¼Ÿ</h2>
                <p>è®©æˆ‘ä»¬å¸®æ‚¨è§„åˆ’ä¸€æ¡ä¸“å±äºæ‚¨çš„ç²¾å½©è·¯çº¿ï¼Œå¼€å¯ä¸€æ®µéš¾å¿˜çš„æ—…ç¨‹ã€‚</p>
                <div class="cta-buttons">
                    <button class="primary-btn">ç«‹å³å’¨è¯¢</button>
                    <button class="secondary-btn">æŸ¥çœ‹æ ·ä¾‹è·¯çº¿</button>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="footer-container">
            <div class="footer-column">
                <h3>æ…¢é‡è‡ªé©¾æ¸¸</h3>
                <p>æ¢ç´¢ä¸­å›½ä¸­è¥¿éƒ¨çš„è‡ªç„¶ä¸æ–‡åŒ–ä¹‹ç¾</p>
                <div class="social-icons">
                    <a href="#"><i class="fab fa-weixin"></i></a>
                    <a href="#"><i class="fab fa-weibo"></i></a>
                    <a href="#"><i class="fab fa-tiktok"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-column">
                <h3>å¿«é€Ÿé“¾æ¥</h3>
                <ul>
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="index.html#routes">è·¯çº¿æ¨è</a></li>
                    <li><a href="index.html#destinations">ç›®çš„åœ°</a></li>
                    <li><a href="index.html#services">æœåŠ¡æŒ‡å—</a></li>
                    <li><a href="index.html#community">ç¤¾åŒº</a></li>
                    <li><a href="index.html#about">å…³äºæˆ‘ä»¬</a></li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>è”ç³»æˆ‘ä»¬</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-phone"></i> 400-123-4567</li>
                    <li><i class="fas fa-envelope"></i> info@manye.travel</li>
                    <li><i class="fas fa-map-marker-alt"></i> æˆéƒ½å¸‚é«˜æ–°åŒºå¤©åºœè½¯ä»¶å›­</li>
                </ul>
            </div>
            <div class="footer-column">
                <h3>è®¢é˜…é€šè®¯</h3>
                <p>è·å–æœ€æ–°çš„è·¯çº¿æ¨èå’Œæ—…è¡Œçµæ„Ÿ</p>
                <form class="subscription-form">
                    <input type="email" placeholder="æ‚¨çš„é‚®ç®±åœ°å€">
                    <button type="submit">è®¢é˜…</button>
                </form>
            </div>
        </div>
        <div class="footer-bottom">
            <p>&copy; 2023 æ…¢é‡è‡ªé©¾æ¸¸ ç‰ˆæƒæ‰€æœ‰</p>
        </div>
    </footer>

    <script src="public/js/main.js"></script>
    <!-- å¼•å…¥åœ°å›¾å·¥å…·JS -->
    <script src="public/js/map-utils.js"></script>
    <script>
        // è®¾ç½®é«˜å¾·åœ°å›¾å®‰å…¨å¯†é’¥ï¼ˆå¿…é¡»åœ¨åŠ è½½JS APIä¹‹å‰è®¾ç½®ï¼‰
        window._AMapSecurityConfig = {
            securityJsCode: '6512b470a154fdfc777257a088527d63', // æ­£ç¡®çš„å®‰å…¨å¯†é’¥
        };

        // å…¨å±€APIå¯†é’¥è®¾ç½®
        const JS_API_KEY = '90e1c6ecd1322b3d3fc32afadd55d714'; // Webç«¯JS APIå¯†é’¥
        const WEB_SERVICE_API_KEY = '90e1c6ecd1322b3d3fc32afadd55d714'; // WebæœåŠ¡APIå¯†é’¥
        
        // å¼ºåˆ¶ä½¿ç”¨JS APIå¯†é’¥æ¥æ›¿ä»£WebæœåŠ¡APIå¯†é’¥ï¼Œå› ä¸ºå®ƒå¯èƒ½æœ‰æ›´å°‘çš„åŸŸåé™åˆ¶
        window.WEB_SERVICE_API_KEY = JS_API_KEY;
        
        // å…¨å±€æ£€æµ‹å‡½æ•°ï¼Œå¯åœ¨æ§åˆ¶å°è°ƒç”¨ï¼šcheckApiKey()
        window.checkApiKey = function() {
            console.group('ğŸ”‘ APIå¯†é’¥çŠ¶æ€æ£€æŸ¥');
            console.log('JS APIå¯†é’¥ (Webç«¯):', JS_API_KEY);
            console.log('WebæœåŠ¡APIå¯†é’¥:', window.WEB_SERVICE_API_KEY);
            
            // æ˜¾ç¤ºåŸŸåä¿¡æ¯
            console.log('å½“å‰åŸŸå:', window.location.hostname);
            console.log('å®Œæ•´URL:', window.location.href);
            
            // æµ‹è¯•API
            const testGeoURL = `https://restapi.amap.com/v3/geocode/geo?address=åŒ—äº¬&key=${window.WEB_SERVICE_API_KEY}`;
            console.log('æµ‹è¯•è¯·æ±‚URL:', testGeoURL);
            
            fetch(testGeoURL)
                .then(response => response.json())
                .then(data => {
                    console.log('APIæµ‹è¯•ç»“æœ:', data);
                    if (data.status === '1') {
                        console.log('âœ… APIå¯†é’¥æ­£å¸¸å·¥ä½œ');
                    } else {
                        console.error('âŒ APIå¯†é’¥é”™è¯¯:', data.info);
                        console.warn('æç¤º: åœ¨æ§åˆ¶å°è¾“å…¥ useJsApiForWebService() å°è¯•ä½¿ç”¨JS APIå¯†é’¥ä½œä¸ºWebæœåŠ¡å¯†é’¥');
                    }
                })
                .catch(error => {
                    console.error('âŒ APIè¯·æ±‚å¤±è´¥:', error);
                })
                .finally(() => {
                    console.groupEnd();
                });
        };
        
        // è¾…åŠ©å‡½æ•°ï¼Œç”¨äºåœ¨APIå¯†é’¥é—®é¢˜æ—¶åˆ‡æ¢ä½¿ç”¨JS APIä½œä¸ºWebæœåŠ¡API
        window.useJsApiForWebService = function() {
            window.WEB_SERVICE_API_KEY = JS_API_KEY;
            console.log('ç°åœ¨ä½¿ç”¨JS APIå¯†é’¥ä½œä¸ºWebæœåŠ¡å¯†é’¥:', WEB_SERVICE_API_KEY);
            console.log('å¯ä»¥å°è¯•å†æ¬¡è§„åˆ’è·¯çº¿');
        };
        
        // è®°å½•ç½‘ç«™åŸŸåï¼Œç”¨äºè°ƒè¯•è·¨åŸŸé—®é¢˜
        document.addEventListener('DOMContentLoaded', function() {
            console.log('å½“å‰ç½‘ç«™åŸŸå:', window.location.hostname);
            console.log('å®Œæ•´URL:', window.location.href);
            
            // æ£€æŸ¥æ˜¯å¦åœ¨lvxingchina.comä¸Šï¼Œå¦‚æœæ˜¯ï¼Œæä¾›ç‰¹æ®Šå¤„ç†
            const isLvxingChinaSite = window.location.hostname.includes('lvxingchina.com');
            if (isLvxingChinaSite) {
                console.log('æ£€æµ‹åˆ°åœ¨lvxingchina.comä¸Šè¿è¡Œï¼Œä½¿ç”¨é€‚é…çš„APIå¯†é’¥');
                
                // å¯¹äºlvxingchina.comåŸŸåï¼Œä½¿ç”¨æ²¡æœ‰åŸŸåé™åˆ¶çš„APIå¯†é’¥æˆ–é€‚é…çš„APIå¯†é’¥
                // è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨JS APIå¯†é’¥ä½œä¸ºWebæœåŠ¡å¯†é’¥ï¼Œå› ä¸ºå®ƒä»¬åœ¨å½“å‰ç¤ºä¾‹ä¸­æ˜¯åŒä¸€ä¸ª
                window.WEB_SERVICE_API_KEY = JS_API_KEY;
                
                // è®¾ç½®æç¤º
                alert('æ£€æµ‹åˆ°åœ¨lvxingchina.comä¸Šè¿è¡Œï¼Œéƒ¨åˆ†åœ°å›¾åŠŸèƒ½å¯èƒ½å—é™ã€‚è¯·å‘ç®¡ç†å‘˜ç”³è¯·å°†è¯¥åŸŸåæ·»åŠ åˆ°é«˜å¾·åœ°å›¾APIç™½åå•ã€‚');
            }
            
            // å¦‚æœæ˜¯åœ¨è·¨åŸŸç¯å¢ƒä¸‹ï¼Œè¾“å‡ºæç¤º
            if (window.location.hostname !== 'localhost' && 
                window.location.hostname !== '127.0.0.1' && 
                !window.location.hostname.includes('manye')) {
                console.warn('è­¦å‘Š: å½“å‰åŸŸåå¯èƒ½æœªåœ¨é«˜å¾·åœ°å›¾APIå¯†é’¥çš„ç™½åå•ä¸­');
            }
            
            // APIå¯†é’¥è°ƒè¯•ä¿¡æ¯
            console.log('JS APIå¯†é’¥(Webç«¯): 90e1c6ecd1322b3d3fc32afadd55d714');
            console.log('WebæœåŠ¡APIå¯†é’¥: 90e1c6ecd1322b3d3fc32afadd55d714');
        });
        
        // å¤„ç†FAQå±•å¼€/æ”¶èµ·çš„äº¤äº’
        document.addEventListener('DOMContentLoaded', function() {
            // è°ƒè¯•å‡½æ•°ï¼Œæ£€æŸ¥åœ°å›¾APIçŠ¶æ€
            function debugMapSetup() {
                console.log('======= åœ°å›¾è°ƒè¯•ä¿¡æ¯ =======');
                
                // æ˜¾ç¤ºAPIå¯†é’¥ä¿¡æ¯
                console.log('JS APIå¯†é’¥(Webç«¯): ' + JS_API_KEY);
                console.log('WebæœåŠ¡APIå¯†é’¥: ' + WEB_SERVICE_API_KEY);
                
                // æ£€æŸ¥æ˜¯å¦æ­£ç¡®è®¾ç½®äº†å®‰å…¨å¯†é’¥
                if (window._AMapSecurityConfig && window._AMapSecurityConfig.securityJsCode) {
                    console.log('å®‰å…¨å¯†é’¥å·²æ­£ç¡®è®¾ç½®:', window._AMapSecurityConfig.securityJsCode);
                } else {
                    console.warn('è­¦å‘Š: æœªæ£€æµ‹åˆ°å®‰å…¨å¯†é’¥è®¾ç½®ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ°å›¾APIåŠ è½½å¤±è´¥');
                }
                
                // æ£€æŸ¥MapUtilsæ˜¯å¦å­˜åœ¨
                if (window.MapUtils) {
                    console.log('MapUtilså·¥å…·å·²åŠ è½½');
                } else {
                    console.error('MapUtilså·¥å…·æœªåŠ è½½ï¼Œè¿™å¯èƒ½å¯¼è‡´åœ°å›¾æ— æ³•æ˜¾ç¤º');
                }
                
                // æ£€æŸ¥åœ°å›¾å®¹å™¨
                const mapContainer = document.getElementById('route-planning-map');
                if (mapContainer) {
                    console.log('åœ°å›¾å®¹å™¨å­˜åœ¨');
                    console.log('å®¹å™¨å°ºå¯¸:', mapContainer.offsetWidth, 'x', mapContainer.offsetHeight);
                    
                    // æ£€æŸ¥å®¹å™¨æ ·å¼
                    const computedStyle = window.getComputedStyle(mapContainer);
                    console.log('å®¹å™¨å¯è§æ€§:', computedStyle.display, computedStyle.visibility);
                    console.log('å®¹å™¨èƒŒæ™¯:', computedStyle.backgroundColor, computedStyle.backgroundImage);
                    
                    // ç¡®ä¿å®¹å™¨å¤§å°è¶³å¤Ÿ
                    if (mapContainer.offsetWidth < 50 || mapContainer.offsetHeight < 50) {
                        console.error('åœ°å›¾å®¹å™¨å°ºå¯¸å¤ªå°ï¼Œå¯èƒ½å¯¼è‡´åœ°å›¾æ— æ³•æ­£å¸¸æ˜¾ç¤º');
                    }
                } else {
                    console.error('åœ°å›¾å®¹å™¨ä¸å­˜åœ¨ï¼Œæ— æ³•æ˜¾ç¤ºåœ°å›¾');
                }
                
                // æ£€æŸ¥ç½‘ç»œè¿æ¥
                if (navigator.onLine) {
                    console.log('ç½‘ç»œå·²è¿æ¥');
                    
                    // æµ‹è¯•é«˜å¾·åœ°å›¾æœåŠ¡å™¨è¿æ¥
                    const testImage = new Image();
                    testImage.onload = function() {
                        console.log('å¯ä»¥è®¿é—®é«˜å¾·åœ°å›¾æœåŠ¡å™¨');
                    };
                    testImage.onerror = function() {
                        console.error('æ— æ³•è®¿é—®é«˜å¾·åœ°å›¾æœåŠ¡å™¨ï¼Œå¯èƒ½æ˜¯ç½‘ç»œé—®é¢˜æˆ–APIå¯†é’¥è¢«ç¦ç”¨');
                    };
                    testImage.src = 'https://webapi.amap.com/theme/v1.3/markers/n/mark_b.png';
                } else {
                    console.error('ç½‘ç»œæœªè¿æ¥ï¼Œæ— æ³•åŠ è½½åœ°å›¾API');
                }
                
                console.log('======= è°ƒè¯•ä¿¡æ¯ç»“æŸ =======');
            }
            
            // æ‰§è¡Œè°ƒè¯•æ£€æŸ¥
            debugMapSetup();
            
            const faqItems = document.querySelectorAll('.faq-item');
            
            faqItems.forEach(item => {
                const question = item.querySelector('.faq-question');
                
                question.addEventListener('click', () => {
                    // åˆ‡æ¢å½“å‰é—®é¢˜çš„æ¿€æ´»çŠ¶æ€
                    item.classList.toggle('active');
                    
                    // å…³é—­å…¶ä»–æ‰“å¼€çš„é—®é¢˜ï¼ˆå¯é€‰ï¼Œå–æ¶ˆæ³¨é‡Šä»¥å¯ç”¨æ­¤åŠŸèƒ½ï¼‰
                    // faqItems.forEach(otherItem => {
                    //     if(otherItem !== item && otherItem.classList.contains('active')) {
                    //         otherItem.classList.remove('active');
                    //     }
                    // });
                });
            });
            
            // è·¯çº¿è§„åˆ’æŒ‰é’®ç‚¹å‡»äº‹ä»¶
            const planRouteBtn = document.querySelector('.plan-route-btn');
            if (planRouteBtn) {
                planRouteBtn.addEventListener('click', function() {
                    // æ¸…é™¤ä¹‹å‰çš„è·¯çº¿å’Œæ ‡è®°
                    if (window.routeMap) {
                        window.routeMap.clearMap();
                    }
                    if (window.drivingService && window.drivingService.clear) {
                        window.drivingService.clear();
                    }
                    
                    // è®¾ç½®æŒ‰é’®ä¸ºåŠ è½½çŠ¶æ€
                    this.disabled = true;
                    this.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è§„åˆ’ä¸­...';
                    
                    // ç»˜åˆ¶è·¯çº¿
                    drawRouteOnMap();
                });
            }
            
            // ç»‘å®šç¤ºä¾‹è·¯çº¿ç‚¹å‡»äº‹ä»¶
            const exampleRoutes = document.querySelectorAll('.example-route');
            exampleRoutes.forEach(route => {
                route.addEventListener('click', function() {
                    const from = this.dataset.from;
                    const to = this.dataset.to;
                    
                    if (from && to) {
                        document.getElementById('start-point').value = from;
                        document.getElementById('end-point').value = to;
                        
                        // è§¦å‘è·¯çº¿è§„åˆ’
                        if (planRouteBtn) planRouteBtn.click();
                    }
                });
            });
            
            // è·å–URLå‚æ•°
            const urlParams = new URLSearchParams(window.location.search);
            const serviceType = urlParams.get('service');
            
            // æ ¹æ®æœåŠ¡ç±»å‹æ›´æ–°é¡µé¢å†…å®¹
            updateServiceContent(serviceType);
        });
        
        // æ›´æ–°æœåŠ¡å†…å®¹å‡½æ•°
        function updateServiceContent(serviceType) {
            // é»˜è®¤ä¸ºè·¯çº¿è§„åˆ’æœåŠ¡
            let title = 'æ™ºèƒ½è·¯çº¿è§„åˆ’';
            let description = 'åŸºäºé«˜å¾·åœ°å›¾APIï¼Œæ ¹æ®æ‚¨çš„å–œå¥½ã€æ—¶é—´å’Œå­£èŠ‚ï¼Œæ™ºèƒ½è§„åˆ’æœ€é€‚åˆçš„è‡ªé©¾è·¯çº¿ï¼ŒåŒ…å«å®æ—¶è·¯å†µå’Œè·¯çº¿åå¥½';
            let icon = 'fa-map-marked-alt';
            let showMapDemo = true;
            
            // æ ¹æ®æœåŠ¡ç±»å‹è®¾ç½®æ ‡é¢˜å’Œæè¿°
            switch(serviceType) {
                case 'route-planning':
                    // é»˜è®¤å€¼å·²è®¾ç½®
                    break;
                case 'accommodation':
                    title = 'ä½å®¿æ¨è';
                    description = 'æ•´åˆæºç¨‹ã€ç¾å›¢ç­‰å¹³å°èµ„æºï¼Œä¸ºæ‚¨æ¨èæ²¿é€”ä¼˜è´¨ä½å®¿ï¼Œæ¶µç›–é…’åº—ã€æ°‘å®¿ã€éœ²è¥åœ°ç­‰å¤šç§ç±»å‹ï¼Œæ»¡è¶³ä¸åŒé¢„ç®—éœ€æ±‚';
                    icon = 'fa-hotel';
                    showMapDemo = false;
                    break;
                case 'food-guide':
                    title = 'ç¾é£ŸæŒ‡å—';
                    description = 'ç»“åˆå¤§ä¼—ç‚¹è¯„æ•°æ®ï¼Œå‘ç°æ²¿é€”ç‰¹è‰²ç¾é£Ÿï¼Œæä¾›å°ä¼—é¤å…å’Œåœ°é“é£å‘³æ¨èï¼Œè®©æ‚¨ä½“éªŒçœŸæ­£çš„å½“åœ°ç¾é£Ÿæ–‡åŒ–';
                    icon = 'fa-utensils';
                    showMapDemo = false;
                    break;
                case 'safety':
                    title = 'å®‰å…¨ä¿éšœ';
                    description = 'ä¸ä¸­å›½å¹³å®‰åˆä½œï¼Œæä¾›ç´§æ€¥æ•‘æ´ä¿¡æ¯ã€è·¯å†µé¢„è­¦å’Œäº‹æ•…å¤„ç†æŒ‡å—ï¼ŒåŒ…å«ä¸€é”®å‘¼å«é™„è¿‘æ•‘æ´å’Œç»´ä¿®æœåŠ¡';
                    icon = 'fa-car-crash';
                    showMapDemo = false;
                    break;
                case 'supply-network':
                    title = 'æ™ºèƒ½è¡¥ç»™ç½‘ç»œ';
                    description = 'åŸºäºè…¾è®¯ä½ç½®æœåŠ¡ï¼Œæä¾›å…¨å›½åŠ æ²¹ç«™ã€å……ç”µæ¡©ã€æœåŠ¡åŒºç­‰è¡¥ç»™ç‚¹å®æ—¶æ•°æ®ï¼Œæ”¯æŒé¢„çº¦å’Œå¯¼èˆªï¼Œè§£å†³åè¿œåœ°åŒºè¡¥ç»™éš¾é¢˜';
                    icon = 'fa-gas-pump';
                    showMapDemo = true;
                    break;
                case 'online-assistant':
                    title = 'æ™ºèƒ½åœ¨çº¿åŠ©æ‰‹';
                    description = 'é›†æˆå¾®ä¿¡å°ç¨‹åºï¼Œæä¾›å…¨å¤©å€™åœ¨çº¿å’¨è¯¢å’ŒAIæ™ºèƒ½åŠ©æ‰‹æœåŠ¡ï¼Œè§£ç­”æ—…é€”é—®é¢˜å¹¶æä¾›ç´§æ€¥æ”¯æŒï¼Œæ”¯æŒç¦»çº¿æ¨¡å¼';
                    icon = 'fa-phone-alt';
                    showMapDemo = false;
                    break;
            }
            
            // æ›´æ–°é¡µé¢å†…å®¹
            document.getElementById('service-title').textContent = title;
            document.getElementById('service-description').textContent = description;
            
            // æ›´æ–°å›¾æ ‡
            const iconElement = document.getElementById('service-icon');
            if (iconElement) {
                iconElement.className = '';
                iconElement.classList.add('fas', icon);
            }
            
            // æ˜¾ç¤ºæˆ–éšè—åœ°å›¾æ¼”ç¤ºéƒ¨åˆ†
            const mapDemoSection = document.getElementById('map-demo-section');
            if (mapDemoSection) {
                mapDemoSection.style.display = showMapDemo ? 'block' : 'none';
            }
            
            // å¦‚æœæ˜¾ç¤ºåœ°å›¾æ¼”ç¤ºï¼Œåˆ™åŠ è½½åœ°å›¾API
            if (showMapDemo) {
                loadMapAPI();
            }
        }
        
        // ç»˜åˆ¶è·¯çº¿å‡½æ•°
        function drawRouteOnMap() {
            console.log('å¼€å§‹è§„åˆ’è·¯çº¿...ä½¿ç”¨APIå¯†é’¥:', WEB_SERVICE_API_KEY);
            console.log('å¦‚æœä»ç„¶å‡ºç°INVALID_USER_KEYé”™è¯¯ï¼Œè¯·å°è¯•æ¸…é™¤æµè§ˆå™¨ç¼“å­˜æˆ–ä½¿ç”¨éšç§çª—å£');
            
            const startPoint = document.getElementById('start-point').value.trim();
            const endPoint = document.getElementById('end-point').value.trim();
            const planRouteBtn = document.querySelector('.plan-route-btn');
            
            if (!startPoint || !endPoint) {
                alert('è¯·è¾“å…¥èµ·ç‚¹å’Œç»ˆç‚¹');
                // é‡ç½®æŒ‰é’®çŠ¶æ€
                if (planRouteBtn) {
                    planRouteBtn.disabled = false;
                    planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                }
                return;
            }
            
            console.log(`èµ·ç‚¹: ${startPoint}, ç»ˆç‚¹: ${endPoint}`);
            
            // æ£€æŸ¥åœ°å›¾æ˜¯å¦å·²åŠ è½½
            if (!window.AMap) {
                console.error('é«˜å¾·åœ°å›¾APIæœªåŠ è½½');
                alert('åœ°å›¾APIæœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                // é‡ç½®æŒ‰é’®çŠ¶æ€
                if (planRouteBtn) {
                    planRouteBtn.disabled = false;
                    planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                }
                return;
            }
            
            if (!window.routeMap) {
                console.error('åœ°å›¾å®ä¾‹æœªåˆ›å»º');
                
                // å°è¯•é‡æ–°åˆå§‹åŒ–åœ°å›¾
                console.log('å°è¯•é‡æ–°åˆå§‹åŒ–åœ°å›¾...');
                initAMap();
                
                setTimeout(() => {
                    if (window.routeMap) {
                        console.log('åœ°å›¾åˆå§‹åŒ–æˆåŠŸï¼Œé‡æ–°å°è¯•è§„åˆ’è·¯çº¿');
                        drawRouteOnMap();
                    } else {
                        alert('åœ°å›¾æœªåˆå§‹åŒ–ï¼Œè¯·åˆ·æ–°é¡µé¢é‡è¯•');
                        // é‡ç½®æŒ‰é’®çŠ¶æ€
                        if (planRouteBtn) {
                            planRouteBtn.disabled = false;
                            planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                        }
                    }
                }, 1000);
                
                return;
            }
            
            if (!window.drivingService) {
                console.log('æ­£åœ¨åˆå§‹åŒ–é©¾è½¦æœåŠ¡...');
                // åˆå§‹åŒ–é©¾è½¦æœåŠ¡
                window.routeMap.plugin(['AMap.Driving'], function() {
                    window.drivingService = new AMap.Driving({
                        map: window.routeMap,
                        policy: AMap.DrivingPolicy.LEAST_TIME
                    });
                    console.log('é©¾è½¦æœåŠ¡åˆå§‹åŒ–æˆåŠŸï¼Œæ­£åœ¨è§„åˆ’è·¯çº¿...');
                    // é‡æ–°è°ƒç”¨ç»˜åˆ¶è·¯çº¿
                    continueDrawRoute(startPoint, endPoint, planRouteBtn);
                });
            } else {
                // ç›´æ¥ç»§ç»­ç»˜åˆ¶è·¯çº¿
                continueDrawRoute(startPoint, endPoint, planRouteBtn);
            }
        }
        
        // ç»§ç»­ç»˜åˆ¶è·¯çº¿ï¼ˆæå–ä¸ºå•ç‹¬å‡½æ•°ï¼Œç”¨äºé‡è¯•é€»è¾‘ï¼‰
        function continueDrawRoute(startPoint, endPoint, planRouteBtn) {
            // æ¸…é™¤ä¹‹å‰çš„è·¯çº¿
            if (window.drivingService && window.drivingService.clear) {
                window.drivingService.clear();
            }
            
            console.log('æ­£åœ¨è§„åˆ’ä»', startPoint, 'åˆ°', endPoint, 'çš„è·¯çº¿...');
            
            // è®¾ç½®è¶…æ—¶å¤„ç†
            let timeoutId = setTimeout(() => {
                console.error('è·¯çº¿è§„åˆ’è¯·æ±‚è¶…æ—¶ï¼Œåˆ‡æ¢åˆ°WebæœåŠ¡API');
                if (planRouteBtn) {
                    planRouteBtn.disabled = false;
                    planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                }
                
                // ä½¿ç”¨WebæœåŠ¡APIä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                useWebServiceRouting(startPoint, endPoint, planRouteBtn);
            }, 8000); // 8ç§’è¶…æ—¶
            
            // é¦–å…ˆå°†åœ°ç‚¹åç§°è½¬æ¢ä¸ºåæ ‡
            geocodeAddresses(startPoint, endPoint)
                .then(coordinates => {
                    console.log('åœ°ç†ç¼–ç æˆåŠŸ:', coordinates);
                    
                    if (!coordinates.start || !coordinates.end) {
                        throw new Error('åœ°ç†ç¼–ç å¤±è´¥ï¼Œæ— æ³•è·å–å‡†ç¡®ä½ç½®');
                    }
                    
                    // æ¸…é™¤è¶…æ—¶å¤„ç†
                    clearTimeout(timeoutId);
                    
                    // ä½¿ç”¨è·å–çš„åæ ‡è§„åˆ’è·¯çº¿
                    return searchRoute(coordinates.start, coordinates.end, planRouteBtn);
                })
                .catch(error => {
                    console.error('åœ°ç†ç¼–ç æˆ–è·¯çº¿è§„åˆ’å¤±è´¥:', error);
                    
                    // æ¸…é™¤è¶…æ—¶å¤„ç†
                    clearTimeout(timeoutId);
                    
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    if (planRouteBtn) {
                        planRouteBtn.disabled = false;
                        planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                    }
                    
                    // å›é€€åˆ°ç›´æ¥ä½¿ç”¨WebæœåŠ¡API
                    console.log('å°è¯•ä½¿ç”¨WebæœåŠ¡APIè§„åˆ’è·¯çº¿...');
                    useWebServiceRouting(startPoint, endPoint, planRouteBtn);
                });
        }
        
        // åœ°ç†ç¼–ç å‡½æ•° - ä½¿ç”¨WebæœåŠ¡APIè°ƒç”¨
        function geocodeAddresses(startAddress, endAddress) {
            return new Promise((resolve, reject) => {
                // ç¡®ä¿AMapå·²åŠ è½½
                if (!window.AMap) {
                    reject(new Error('é«˜å¾·åœ°å›¾APIæœªåŠ è½½'));
                    return;
                }
                
                // é¦–å…ˆå°è¯•ä½¿ç”¨JavaScript APIçš„åœ°ç†ç¼–ç 
                try {
                    // åŠ è½½åœ°ç†ç¼–ç æ’ä»¶
                    AMap.plugin('AMap.Geocoder', function() {
                        const geocoder = new AMap.Geocoder({
                            city: "å…¨å›½", // åŸå¸‚ï¼Œé»˜è®¤"å…¨å›½"
                            radius: 1000 // èŒƒå›´ï¼Œé»˜è®¤1000ç±³
                        });
                        
                        const coordinates = {
                            start: null,
                            end: null
                        };
                        
                        // åœ°ç†ç¼–ç èµ·ç‚¹
                        geocoder.getLocation(startAddress, function(status, result) {
                            console.log('èµ·ç‚¹åœ°ç†ç¼–ç ç»“æœ:', status, result);
                            
                            if (status === 'complete' && result.geocodes.length) {
                                coordinates.start = result.geocodes[0].location;
                                
                                // åœ°ç†ç¼–ç ç»ˆç‚¹
                                geocoder.getLocation(endAddress, function(status, result) {
                                    console.log('ç»ˆç‚¹åœ°ç†ç¼–ç ç»“æœ:', status, result);
                                    
                                    if (status === 'complete' && result.geocodes.length) {
                                        coordinates.end = result.geocodes[0].location;
                                        resolve(coordinates);
                                    } else {
                                        // å¦‚æœJavaScript APIå¤±è´¥ï¼Œå°è¯•ä½¿ç”¨WebæœåŠ¡API
                                        fallbackToWebServiceGeocode(startAddress, endAddress, coordinates)
                                            .then(resolve)
                                            .catch(reject);
                                    }
                                });
                            } else {
                                // å¦‚æœJavaScript APIå¤±è´¥ï¼Œå°è¯•ä½¿ç”¨WebæœåŠ¡API
                                fallbackToWebServiceGeocode(startAddress, endAddress, coordinates)
                                    .then(resolve)
                                    .catch(reject);
                            }
                        });
                    });
                } catch (error) {
                    console.error('åœ°ç†ç¼–ç æ’ä»¶åŠ è½½å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨WebæœåŠ¡API', error);
                    fallbackToWebServiceGeocode(startAddress, endAddress, {start: null, end: null})
                        .then(resolve)
                        .catch(reject);
                }
            });
        }
        
        // å¤‡ç”¨æ–¹æ¡ˆï¼šä½¿ç”¨WebæœåŠ¡APIè¿›è¡Œåœ°ç†ç¼–ç 
        function fallbackToWebServiceGeocode(startAddress, endAddress, coordinates) {
            return new Promise((resolve, reject) => {
                console.log('ä½¿ç”¨WebæœåŠ¡APIè¿›è¡Œåœ°ç†ç¼–ç ');
                
                // ä½¿ç”¨å…¨å±€WebæœåŠ¡APIå¯†é’¥
                console.log('[åœ°ç†ç¼–ç ]ä½¿ç”¨çš„WebæœåŠ¡APIå¯†é’¥:', WEB_SERVICE_API_KEY);
                
                // é’ˆå¯¹lvxingchina.comåŸŸåçš„ç‰¹æ®Šå¤„ç†
                let apiKey = WEB_SERVICE_API_KEY;
                if (window.location.hostname.includes('lvxingchina.com')) {
                    // å¦‚æœåœ¨lvxingchina.comä¸Šï¼Œåˆ‡æ¢åˆ°JS APIå¯†é’¥ï¼ˆå‡è®¾å®ƒæœ‰æ›´å°‘çš„åŸŸåé™åˆ¶ï¼‰
                    apiKey = JS_API_KEY;
                    console.log('[ç‰¹æ®Šå¤„ç†] åœ¨lvxingchina.comä¸Šä½¿ç”¨æ›¿ä»£å¯†é’¥è¿›è¡Œåœ°ç†ç¼–ç ');
                }
                
                // é¦–å…ˆå¤„ç†èµ·ç‚¹
                if (!coordinates.start) {
                    // åˆ›å»ºä¸€ä¸ªAJAXè¯·æ±‚æ¥è°ƒç”¨WebæœåŠ¡API
                    const startXhr = new XMLHttpRequest();
                    startXhr.open('GET', `https://restapi.amap.com/v3/geocode/geo?address=${encodeURIComponent(startAddress)}&key=${apiKey}`, true);
                    
                    startXhr.onload = function() {
                        if (startXhr.status === 200) {
                            const response = JSON.parse(startXhr.responseText);
                            console.log('èµ·ç‚¹WebæœåŠ¡åœ°ç†ç¼–ç ç»“æœ:', response);
                            
                            if (response.status === '1' && response.geocodes && response.geocodes.length > 0) {
                                // è§£æç»çº¬åº¦å­—ç¬¦ä¸² "116.481499,39.990475"
                                const locationParts = response.geocodes[0].location.split(',');
                                coordinates.start = new AMap.LngLat(parseFloat(locationParts[0]), parseFloat(locationParts[1]));
                                
                                // ç»§ç»­å¤„ç†ç»ˆç‚¹
                                processEndPoint();
                            } else {
                                reject(new Error('èµ·ç‚¹åœ°ç†ç¼–ç å¤±è´¥: ' + (response.info || 'æœªçŸ¥é”™è¯¯')));
                            }
                        } else {
                            reject(new Error('èµ·ç‚¹åœ°ç†ç¼–ç è¯·æ±‚å¤±è´¥: ' + startXhr.status));
                        }
                    };
                    
                    startXhr.onerror = function() {
                        reject(new Error('èµ·ç‚¹åœ°ç†ç¼–ç ç½‘ç»œé”™è¯¯'));
                    };
                    
                    startXhr.send();
                } else {
                    // å¦‚æœèµ·ç‚¹å·²æœ‰åæ ‡ï¼Œç›´æ¥å¤„ç†ç»ˆç‚¹
                    processEndPoint();
                }
                
                // å¤„ç†ç»ˆç‚¹å‡½æ•°
                function processEndPoint() {
                    if (!coordinates.end) {
                        const endXhr = new XMLHttpRequest();
                        endXhr.open('GET', `https://restapi.amap.com/v3/geocode/geo?address=${encodeURIComponent(endAddress)}&key=${apiKey}`, true);
                        
                        endXhr.onload = function() {
                            if (endXhr.status === 200) {
                                const response = JSON.parse(endXhr.responseText);
                                console.log('ç»ˆç‚¹WebæœåŠ¡åœ°ç†ç¼–ç ç»“æœ:', response);
                                
                                if (response.status === '1' && response.geocodes && response.geocodes.length > 0) {
                                    // è§£æç»çº¬åº¦å­—ç¬¦ä¸²
                                    const locationParts = response.geocodes[0].location.split(',');
                                    coordinates.end = new AMap.LngLat(parseFloat(locationParts[0]), parseFloat(locationParts[1]));
                                    
                                    // è¿”å›å®Œæ•´ç»“æœ
                                    resolve(coordinates);
                                } else {
                                    reject(new Error('ç»ˆç‚¹åœ°ç†ç¼–ç å¤±è´¥: ' + (response.info || 'æœªçŸ¥é”™è¯¯')));
                                }
                            } else {
                                reject(new Error('ç»ˆç‚¹åœ°ç†ç¼–ç è¯·æ±‚å¤±è´¥: ' + endXhr.status));
                            }
                        };
                        
                        endXhr.onerror = function() {
                            reject(new Error('ç»ˆç‚¹åœ°ç†ç¼–ç ç½‘ç»œé”™è¯¯'));
                        };
                        
                        endXhr.send();
                    } else {
                        // å¦‚æœç»ˆç‚¹å·²æœ‰åæ ‡ï¼Œç›´æ¥è¿”å›ç»“æœ
                        resolve(coordinates);
                    }
                }
            });
        }
        
        // æœç´¢è·¯çº¿å‡½æ•°
        function searchRoute(start, end, planRouteBtn) {
            return new Promise((resolve, reject) => {
                console.log('å¼€å§‹è§„åˆ’è·¯çº¿ï¼Œèµ·ç‚¹:', start, 'ç»ˆç‚¹:', end);
                
                // æ£€æŸ¥æ˜¯å¦ä¸ºåæ ‡å¯¹è±¡ï¼Œå°†å…¶è½¬æ¢ä¸ºå­—ç¬¦ä¸²
                const startPoint = start instanceof AMap.LngLat ? 
                    start.lng + ',' + start.lat : 
                    (typeof start === 'object' && start.lng ? start.lng + ',' + start.lat : start);
                    
                const endPoint = end instanceof AMap.LngLat ? 
                    end.lng + ',' + end.lat : 
                    (typeof end === 'object' && end.lng ? end.lng + ',' + end.lat : end);
                
                console.log('æ ¼å¼åŒ–åçš„èµ·ç‚¹:', startPoint, 'ç»ˆç‚¹:', endPoint);
                
                // åˆ¤æ–­æ˜¯å¦åº”è¯¥ç›´æ¥ä½¿ç”¨WebæœåŠ¡API
                if (!window.drivingService || typeof window.drivingService.search !== 'function') {
                    console.error('é©¾è½¦æœåŠ¡ä¸å¯ç”¨ï¼Œç›´æ¥ä½¿ç”¨WebæœåŠ¡API');
                    useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                        .then(resolve)
                        .catch(reject);
                    return;
                }
                
                // è®¾ç½®è®¡æ—¶å™¨ï¼Œ5ç§’åå¦‚æœæ²¡æœ‰å“åº”ï¼Œç›´æ¥åˆ‡æ¢åˆ°WebæœåŠ¡API
                const timeoutId = setTimeout(() => {
                    console.error('JavaScript APIè·¯çº¿è§„åˆ’è¶…æ—¶ï¼Œåˆ‡æ¢åˆ°WebæœåŠ¡API');
                    
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    if (planRouteBtn) {
                        planRouteBtn.disabled = false;
                        planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                    }
                    
                    // ç›´æ¥ä½¿ç”¨WebæœåŠ¡API
                    useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                        .then(resolve)
                        .catch(reject);
                }, 5000);
                
                // å…ˆå°è¯•ä½¿ç”¨JavaScript APIè§„åˆ’è·¯çº¿
                try {
                    // è®¾ç½®é©¾è½¦å‚æ•°
                    window.drivingService.search(
                        startPoint, 
                        endPoint, 
                        { extensions: 'all' },
                        function(status, result) {
                            // è¯·æ±‚å·²è¿”å›ï¼Œæ¸…é™¤è¶…æ—¶
                            clearTimeout(timeoutId);
                            
                            console.log('è·¯çº¿è§„åˆ’çŠ¶æ€:', status);
                            console.log('è·¯çº¿è§„åˆ’ç»“æœ:', result);
                            
                            // é‡ç½®æŒ‰é’®çŠ¶æ€
                            if (planRouteBtn) {
                                planRouteBtn.disabled = false;
                                planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                            }
                            
                            if (status === 'complete') {
                                if (result.routes && result.routes.length) {
                                    console.log('æˆåŠŸè·å–è·¯çº¿ï¼Œæ­£åœ¨ç»˜åˆ¶...');
                                    try {
                                        // ç»˜åˆ¶è·¯çº¿
                                        window.drivingService.clear(); // å…ˆæ¸…é™¤ä¹‹å‰çš„è·¯çº¿
                                        window.drivingService.drawRoute(result.routes[0]);
                                        
                                        // è®¾ç½®åœ°å›¾è§†é‡
                                        window.routeMap.setFitView();
                                        
                                        // æ›´æ–°è·¯çº¿ä¿¡æ¯é¢æ¿
                                        updateRouteInfoPanel(result.routes[0], 
                                            typeof start === 'string' ? start : 'å·²é€‰ä½ç½®', 
                                            typeof end === 'string' ? end : 'å·²é€‰ä½ç½®');
                                        
                                        // æ˜¾ç¤ºè§„åˆ’ç»“æœ
                                        const routeItems = document.querySelectorAll('.route-item');
                                        routeItems.forEach(item => {
                                            item.style.display = 'block';
                                        });
                                        
                                        resolve(result);
                                    } catch (drawError) {
                                        console.error('ç»˜åˆ¶è·¯çº¿æ—¶å‡ºé”™:', drawError);
                                        // ä½¿ç”¨WebæœåŠ¡APIä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                                        useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                                            .then(resolve)
                                            .catch(reject);
                                    }
                                } else {
                                    console.error('æœªæ‰¾åˆ°è·¯çº¿ç»“æœï¼Œå°è¯•ä½¿ç”¨WebæœåŠ¡API');
                                    // ä½¿ç”¨WebæœåŠ¡APIä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                                    useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                                        .then(resolve)
                                        .catch(reject);
                                }
                            } else {
                                console.error('è·¯çº¿è§„åˆ’å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨WebæœåŠ¡API');
                                // ä½¿ç”¨WebæœåŠ¡APIä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                                useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                                    .then(resolve)
                                    .catch(reject);
                            }
                        }
                    );
                } catch (error) {
                    // å‘ç”Ÿå¼‚å¸¸ï¼Œæ¸…é™¤è¶…æ—¶
                    clearTimeout(timeoutId);
                    
                    console.error('JavaScript APIè·¯çº¿è§„åˆ’å‡ºé”™:', error);
                    // ä½¿ç”¨WebæœåŠ¡APIä½œä¸ºå¤‡ç”¨æ–¹æ¡ˆ
                    useWebServiceRouting(startPoint, endPoint, planRouteBtn)
                        .then(resolve)
                        .catch(reject);
                }
            });
        }
        
        // ä½¿ç”¨WebæœåŠ¡APIè¿›è¡Œè·¯å¾„è§„åˆ’
        function useWebServiceRouting(startPoint, endPoint, planRouteBtn) {
            return new Promise((resolve, reject) => {
                console.log('ä½¿ç”¨WebæœåŠ¡APIè¿›è¡Œè·¯å¾„è§„åˆ’');
                
                // ç¡®ä¿æŒ‰é’®æ˜¾ç¤ºæ­£åœ¨åŠ è½½çŠ¶æ€
                if (planRouteBtn) {
                    planRouteBtn.disabled = true;
                    planRouteBtn.innerHTML = '<i class="fas fa-spinner fa-spin"></i> è§„åˆ’ä¸­...';
                }
                
                // ä½¿ç”¨å…¨å±€WebæœåŠ¡APIå¯†é’¥
                console.log('[è·¯çº¿è§„åˆ’]ä½¿ç”¨çš„WebæœåŠ¡APIå¯†é’¥:', window.WEB_SERVICE_API_KEY);
                
                // æ£€æµ‹åˆ°é—®é¢˜ï¼Œå°è¯•æä¾›æ›´å¤šçš„é”™è¯¯å¤„ç†
                if (!window.WEB_SERVICE_API_KEY || window.WEB_SERVICE_API_KEY.length < 10) {
                    console.error('APIå¯†é’¥å¼‚å¸¸:', window.WEB_SERVICE_API_KEY);
                    alert('APIå¯†é’¥é…ç½®å¼‚å¸¸ï¼Œè¯·è”ç³»ç®¡ç†å‘˜');
                    if (planRouteBtn) {
                        planRouteBtn.disabled = false;
                        planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                    }
                    return Promise.reject(new Error('APIå¯†é’¥é…ç½®å¼‚å¸¸'));
                }
                
                // é’ˆå¯¹æœ¬åœ°ç¯å¢ƒçš„ç‰¹æ®Šå¤„ç†
                let apiKey = window.WEB_SERVICE_API_KEY;
                
                // æ„å»ºè¯·æ±‚URL
                const reqUrl = `https://restapi.amap.com/v3/direction/driving?origin=${encodeURIComponent(startPoint)}&destination=${encodeURIComponent(endPoint)}&extensions=all&key=${apiKey}`;
                console.log('[è·¯çº¿è§„åˆ’]è¯·æ±‚URL:', reqUrl);
                
                try {
                    // åˆ›å»ºä¸€ä¸ªAJAXè¯·æ±‚æ¥è°ƒç”¨WebæœåŠ¡API
                    const xhr = new XMLHttpRequest();
                    xhr.open('GET', reqUrl, true);
                    
                    // è®¾ç½®è¶…æ—¶å¤„ç†
                    const timeoutId = setTimeout(() => {
                        console.error('WebæœåŠ¡APIè¯·æ±‚è¶…æ—¶');
                        
                        // é‡ç½®æŒ‰é’®çŠ¶æ€
                        if (planRouteBtn) {
                            planRouteBtn.disabled = false;
                            planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                        }
                        
                        // æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯
                        alert('è·¯çº¿è§„åˆ’è¯·æ±‚è¶…æ—¶ï¼Œè¯·ç¨åå†è¯•');
                        reject(new Error('WebæœåŠ¡APIè¯·æ±‚è¶…æ—¶'));
                    }, 10000); // 10ç§’è¶…æ—¶
                    
                    xhr.onload = function() {
                        // æ¸…é™¤è¶…æ—¶
                        clearTimeout(timeoutId);
                        
                        // é‡ç½®æŒ‰é’®çŠ¶æ€
                        if (planRouteBtn) {
                            planRouteBtn.disabled = false;
                            planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                        }
                        
                        if (xhr.status === 200) {
                            try {
                                const response = JSON.parse(xhr.responseText);
                                console.log('WebæœåŠ¡è·¯å¾„è§„åˆ’ç»“æœ:', response);
                                
                                if (response.info === 'USERKEY_PLAT_NOMATCH') {
                                    console.error('APIå¯†é’¥å¹³å°ä¸åŒ¹é…');
                                    alert('APIå¯†é’¥é”™è¯¯: æ— æ³•åœ¨å½“å‰ç¯å¢ƒä¸­ä½¿ç”¨è¯¥å¯†é’¥ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºæ‚¨ä½¿ç”¨çš„å¯†é’¥æœªè¢«å…è®¸åœ¨å½“å‰åŸŸåä¸Šä½¿ç”¨ã€‚');
                                    reject(new Error('APIå¯†é’¥å¹³å°ä¸åŒ¹é…'));
                                    return;
                                }
                                
                                if (response.status === '1' && response.route && response.route.paths && response.route.paths.length > 0) {
                                    // æˆåŠŸè·å–è·¯å¾„
                                    const path = response.route.paths[0];
                                    
                                    // å¦‚æœæœ‰åœ°å›¾å®ä¾‹ï¼Œå°è¯•åœ¨åœ°å›¾ä¸Šç»˜åˆ¶è·¯çº¿
                                    if (window.routeMap) {
                                        try {
                                            // è§£æè·¯å¾„åæ ‡
                                            const steps = path.steps;
                                            const pathCoordinates = [];
                                            
                                            steps.forEach(step => {
                                                const polyline = step.polyline;
                                                if (polyline) {
                                                    const points = polyline.split(';');
                                                    points.forEach(point => {
                                                        const [lng, lat] = point.split(',');
                                                        pathCoordinates.push([parseFloat(lng), parseFloat(lat)]);
                                                    });
                                                }
                                            });
                                            
                                            console.log('è§£æäº†', pathCoordinates.length, 'ä¸ªè·¯å¾„ç‚¹');
                                            
                                            if (pathCoordinates.length === 0) {
                                                console.error('æœªèƒ½è§£æåˆ°è·¯å¾„åæ ‡');
                                                throw new Error('æœªèƒ½è§£æåˆ°è·¯å¾„åæ ‡');
                                            }
                                            
                                            // æ¸…é™¤ä¹‹å‰çš„è·¯çº¿
                                            if (window.drivingService && window.drivingService.clear) {
                                                window.drivingService.clear();
                                            }
                                            
                                            // ç§»é™¤ä¹‹å‰çš„ç›´æ¥æ·»åŠ åˆ°åœ°å›¾çš„å…ƒç´ 
                                            window.routeMap.clearMap();
                                            
                                            // é‡æ–°æ·»åŠ æˆéƒ½çš„æ ‡è®°
                                            const chengduMarker = new AMap.Marker({
                                                position: [104.066801, 30.572961],
                                                title: 'æˆéƒ½',
                                                map: window.routeMap
                                            });
                                            
                                            // åˆ›å»ºæŠ˜çº¿
                                            const polyline = new AMap.Polyline({
                                                path: pathCoordinates,
                                                strokeColor: '#3366FF', 
                                                strokeWeight: 6,
                                                strokeOpacity: 0.8,
                                                zIndex: 100,  // ç¡®ä¿è·¯çº¿æ˜¾ç¤ºåœ¨æœ€ä¸Šå±‚
                                                showDir: true // æ˜¾ç¤ºæ–¹å‘
                                            });
                                            
                                            // æ·»åŠ åˆ°åœ°å›¾
                                            window.routeMap.add(polyline);
                                            
                                            // æ·»åŠ èµ·ç‚¹å’Œç»ˆç‚¹æ ‡è®°
                                            const startMarker = new AMap.Marker({
                                                position: pathCoordinates[0],
                                                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
                                                zIndex: 110,  // æ¯”è·¯çº¿é«˜
                                                offset: new AMap.Pixel(-13, -30)  // è°ƒæ•´åç§»ï¼Œä½¿å›¾æ ‡åº•éƒ¨ä¸­å¿ƒå¯¹é½åæ ‡
                                            });
                                            
                                            const endMarker = new AMap.Marker({
                                                position: pathCoordinates[pathCoordinates.length - 1],
                                                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png',
                                                zIndex: 110,  // æ¯”è·¯çº¿é«˜
                                                offset: new AMap.Pixel(-13, -30)  // è°ƒæ•´åç§»ï¼Œä½¿å›¾æ ‡åº•éƒ¨ä¸­å¿ƒå¯¹é½åæ ‡
                                            });
                                            
                                            window.routeMap.add([startMarker, endMarker]);
                                            
                                            // è°ƒæ•´åœ°å›¾è§†é‡
                                            window.routeMap.setFitView([polyline, startMarker, endMarker]);
                                            
                                            // æ„å»ºä¸€ä¸ªå…¼å®¹JavaScript APIçš„è·¯ç”±å¯¹è±¡
                                            const jsApiCompatibleRoute = {
                                                distance: parseFloat(path.distance),
                                                time: parseFloat(path.duration),
                                                steps: steps.map(step => ({
                                                    instruction: step.instruction,
                                                    cities: []
                                                }))
                                            };
                                            
                                            // æ›´æ–°è·¯çº¿ä¿¡æ¯é¢æ¿
                                            updateRouteInfoPanel(jsApiCompatibleRoute, 
                                                typeof startPoint === 'string' ? startPoint : 'å·²é€‰ä½ç½®', 
                                                typeof endPoint === 'string' ? endPoint : 'å·²é€‰ä½ç½®');
                                            
                                            // æ˜¾ç¤ºè§„åˆ’ç»“æœ
                                            const routeItems = document.querySelectorAll('.route-item');
                                            routeItems.forEach(item => {
                                                item.style.display = 'block';
                                            });
                                            
                                            console.log('æˆåŠŸç»˜åˆ¶è·¯çº¿');
                                        } catch (err) {
                                            console.error('ç»˜åˆ¶WebæœåŠ¡è·¯çº¿å‡ºé”™:', err);
                                            
                                            // å°è¯•ä½¿ç”¨æ›´ç®€å•çš„æ–¹æ³•æ˜¾ç¤ºè·¯çº¿
                                            fallbackSimpleRouteDisplay(
                                                startPoint, 
                                                endPoint, 
                                                path.distance, 
                                                path.duration
                                            );
                                        }
                                    } else {
                                        console.error('åœ°å›¾å®ä¾‹ä¸å­˜åœ¨ï¼Œæ— æ³•ç»˜åˆ¶è·¯çº¿');
                                        fallbackSimpleRouteDisplay(
                                            startPoint, 
                                            endPoint, 
                                            path.distance, 
                                            path.duration
                                        );
                                    }
                                    
                                    resolve(response);
                                } else {
                                    const errorMsg = response.info || 'æœªæ‰¾åˆ°åˆé€‚çš„è·¯çº¿';
                                    console.error('WebæœåŠ¡APIè¿”å›é”™è¯¯:', errorMsg);
                                    alert('è·¯çº¿è§„åˆ’å¤±è´¥: ' + errorMsg);
                                    reject(new Error('WebæœåŠ¡è·¯å¾„è§„åˆ’å¤±è´¥: ' + errorMsg));
                                }
                            } catch (parseError) {
                                console.error('è§£æWebæœåŠ¡APIå“åº”å¤±è´¥:', parseError, xhr.responseText);
                                alert('è·¯çº¿è§„åˆ’æ•°æ®è§£æå¤±è´¥ï¼Œè¯·ç¨åå†è¯•');
                                reject(parseError);
                            }
                        } else {
                            console.error('WebæœåŠ¡APIè¯·æ±‚å¤±è´¥:', xhr.status, xhr.statusText);
                            alert('è·¯çº¿è§„åˆ’è¯·æ±‚å¤±è´¥: ' + xhr.status);
                            reject(new Error('WebæœåŠ¡è·¯å¾„è§„åˆ’è¯·æ±‚å¤±è´¥: ' + xhr.status));
                        }
                    };
                    
                    xhr.onerror = function(e) {
                        // æ¸…é™¤è¶…æ—¶
                        clearTimeout(timeoutId);
                        
                        // é‡ç½®æŒ‰é’®çŠ¶æ€
                        if (planRouteBtn) {
                            planRouteBtn.disabled = false;
                            planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                        }
                        
                        console.error('WebæœåŠ¡APIè¯·æ±‚ç½‘ç»œé”™è¯¯:', e);
                        alert('è·¯çº¿è§„åˆ’ç½‘ç»œè¯·æ±‚å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥');
                        reject(new Error('WebæœåŠ¡è·¯å¾„è§„åˆ’ç½‘ç»œé”™è¯¯'));
                    };
                    
                    xhr.send();
                } catch (error) {
                    console.error('å‘èµ·WebæœåŠ¡è¯·æ±‚å‡ºé”™:', error);
                    
                    // é‡ç½®æŒ‰é’®çŠ¶æ€
                    if (planRouteBtn) {
                        planRouteBtn.disabled = false;
                        planRouteBtn.innerHTML = 'è§„åˆ’è·¯çº¿';
                    }
                    
                    alert('å‘èµ·è·¯çº¿è§„åˆ’è¯·æ±‚å‡ºé”™: ' + error.message);
                    reject(error);
                }
            });
        }
        
        // ç®€å•çš„è·¯çº¿æ˜¾ç¤ºå¤‡ç”¨æ–¹æ¡ˆï¼ˆä¸ä¾èµ–åœ°å›¾ç»˜åˆ¶ï¼‰
        function fallbackSimpleRouteDisplay(startPoint, endPoint, distance, duration) {
            console.log('ä½¿ç”¨ç®€å•æ˜¾ç¤ºæ¨¡å¼å±•ç¤ºè·¯çº¿ä¿¡æ¯');
            
            // è®¡ç®—è€—æ—¶ï¼ˆè½¬æ¢ä¸ºå°æ—¶å’Œåˆ†é’Ÿï¼‰
            const totalTime = duration || 0;
            const hours = Math.floor(totalTime / 3600);
            const minutes = Math.floor((totalTime % 3600) / 60);
            const timeString = hours > 0 ? 
                `${hours}å°æ—¶${minutes}åˆ†é’Ÿ` : 
                `${minutes}åˆ†é’Ÿ`;
            
            // è®¡ç®—è·ç¦»ï¼ˆè½¬æ¢ä¸ºå…¬é‡Œï¼‰
            const distanceKm = ((distance || 0) / 1000).toFixed(1);
            
            // æ„é€ ç®€å•çš„è·¯ç”±å¯¹è±¡
            const simpleRoute = {
                distance: distance,
                time: duration,
                steps: [{
                    instruction: `ä»${startPoint}å‡ºå‘ï¼Œè¡Œé©¶çº¦${distanceKm}å…¬é‡Œï¼Œåˆ°è¾¾${endPoint}`,
                    cities: []
                }]
            };
            
            // æ›´æ–°è·¯çº¿ä¿¡æ¯é¢æ¿
            updateRouteInfoPanel(simpleRoute, startPoint, endPoint);
            
            // æ˜¾ç¤ºè§„åˆ’ç»“æœ
            const routeItems = document.querySelectorAll('.route-item');
            routeItems.forEach(item => {
                item.style.display = 'block';
            });
            
            // å¦‚æœæœ‰åœ°å›¾å®ä¾‹ï¼Œæ·»åŠ ç®€å•æ ‡è®°
            if (window.routeMap) {
                try {
                    // æ¸…é™¤åœ°å›¾ä¸Šçš„æ‰€æœ‰è¦†ç›–ç‰©
                    window.routeMap.clearMap();
                    
                    // å°è¯•æ˜¾ç¤ºç®€å•çš„èµ·ç‚¹å’Œç»ˆç‚¹æ ‡è®°ï¼ˆå¯èƒ½ä¸å‡†ç¡®ï¼‰
                    const geocoder = new AMap.Geocoder();
                    
                    // åœ°ç†ç¼–ç èµ·ç‚¹
                    geocoder.getLocation(startPoint, function(status, result) {
                        if (status === 'complete' && result.geocodes.length) {
                            const startMarker = new AMap.Marker({
                                position: result.geocodes[0].location,
                                title: startPoint,
                                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png',
                                offset: new AMap.Pixel(-13, -30)
                            });
                            
                            window.routeMap.add(startMarker);
                            
                            // åœ°ç†ç¼–ç ç»ˆç‚¹
                            geocoder.getLocation(endPoint, function(status, result) {
                                if (status === 'complete' && result.geocodes.length) {
                                    const endMarker = new AMap.Marker({
                                        position: result.geocodes[0].location,
                                        title: endPoint,
                                        icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png',
                                        offset: new AMap.Pixel(-13, -30)
                                    });
                                    
                                    window.routeMap.add(endMarker);
                                    window.routeMap.setFitView();
                                }
                            });
                        }
                    });
                } catch (err) {
                    console.error('ç®€å•æ ‡è®°æ˜¾ç¤ºå¤±è´¥:', err);
                }
            }
        }
        
        // æ›´æ–°è·¯çº¿ä¿¡æ¯é¢æ¿
        function updateRouteInfoPanel(route, startPoint, endPoint) {
            const infoPanel = document.querySelector('.route-info-panel');
            
            if (!infoPanel || !route) return;
            
            // è®¡ç®—è€—æ—¶ï¼ˆè½¬æ¢ä¸ºå°æ—¶å’Œåˆ†é’Ÿï¼‰
            const totalTime = route.time || 0;
            const hours = Math.floor(totalTime / 3600);
            const minutes = Math.floor((totalTime % 3600) / 60);
            const timeString = hours > 0 ? 
                `${hours}å°æ—¶${minutes}åˆ†é’Ÿ` : 
                `${minutes}åˆ†é’Ÿ`;
            
            // è®¡ç®—è·ç¦»ï¼ˆè½¬æ¢ä¸ºå…¬é‡Œï¼‰
            const distance = route.distance || 0;
            const distanceKm = (distance / 1000).toFixed(1);
            
            // æå–é€”ç»ä¸»è¦åŸå¸‚/åœ°ç‚¹
            let viaPoints = '';
            if (route.steps && route.steps.length > 0) {
                const majorPoints = [];
                route.steps.forEach(step => {
                    if (step.cities && step.cities.length > 0) {
                        step.cities.forEach(city => {
                            if (!majorPoints.includes(city.name)) {
                                majorPoints.push(city.name);
                            }
                        });
                    }
                });
                viaPoints = majorPoints.length > 0 ? majorPoints.join('ã€') : 'æ— ä¸»è¦é€”ç»ç‚¹';
            }
            
            // æ›´æ–°ä¿¡æ¯é¢æ¿
            infoPanel.innerHTML = `
                <div class="route-summary">
                    <h3>è·¯çº¿æ¦‚è§ˆ</h3>
                    <div class="route-stats">
                        <div class="stat-item">
                            <i class="fas fa-map-marker-alt"></i>
                            <span>èµ·ç‚¹ï¼š${startPoint}</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-flag-checkered"></i>
                            <span>ç»ˆç‚¹ï¼š${endPoint}</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-road"></i>
                            <span>æ€»è·ç¦»ï¼š${distanceKm} å…¬é‡Œ</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span>é¢„è®¡æ—¶é—´ï¼š${timeString}</span>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-map-signs"></i>
                            <span>é€”ç»ï¼š${viaPoints}</span>
                        </div>
                    </div>
                </div>
                <div class="route-details">
                    <h3>è·¯çº¿è¯¦æƒ…</h3>
                    <div class="route-steps">
                        ${generateRouteSteps(route)}
                    </div>
                </div>
                <div class="route-actions">
                    <button class="btn save-route-btn">
                        <i class="fas fa-save"></i> ä¿å­˜è·¯çº¿
                    </button>
                    <button class="btn share-route-btn">
                        <i class="fas fa-share-alt"></i> åˆ†äº«
                    </button>
                </div>
            `;
            
            // æ·»åŠ ä¿å­˜è·¯çº¿çš„äº‹ä»¶ç›‘å¬
            const saveBtn = infoPanel.querySelector('.save-route-btn');
            if (saveBtn) {
                saveBtn.addEventListener('click', function() {
                    // è¿™é‡Œå¯ä»¥æ·»åŠ ä¿å­˜è·¯çº¿åˆ°ç”¨æˆ·è´¦æˆ·çš„åŠŸèƒ½
                    alert('è·¯çº¿å·²ä¿å­˜ï¼å®é™…åŠŸèƒ½å°†åœ¨è´¦æˆ·ç³»ç»Ÿå®ç°åå®Œæˆã€‚');
                });
            }
            
            // æ·»åŠ åˆ†äº«è·¯çº¿çš„äº‹ä»¶ç›‘å¬
            const shareBtn = infoPanel.querySelector('.share-route-btn');
            if (shareBtn) {
                shareBtn.addEventListener('click', function() {
                    // è¿™é‡Œå¯ä»¥æ·»åŠ åˆ†äº«è·¯çº¿çš„åŠŸèƒ½
                    const shareUrl = generateShareUrl(startPoint, endPoint);
                    navigator.clipboard.writeText(shareUrl)
                        .then(() => alert('åˆ†äº«é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼'))
                        .catch(() => alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨å¤åˆ¶ï¼š' + shareUrl));
                });
            }
        }
        
        // ç”Ÿæˆè·¯çº¿æ­¥éª¤HTML
        function generateRouteSteps(route) {
            if (!route.steps || route.steps.length === 0) {
                return '<p>æ²¡æœ‰è¯¦ç»†è·¯çº¿ä¿¡æ¯</p>';
            }
            
            let stepsHtml = '';
            route.steps.forEach((step, index) => {
                if (index < 10) { // åªæ˜¾ç¤ºå‰10ä¸ªæ­¥éª¤ï¼Œé¿å…è¿‡é•¿
                    stepsHtml += `
                        <div class="route-step">
                            <div class="step-number">${index + 1}</div>
                            <div class="step-instruction">${step.instruction || 'è¡Œé©¶è‡³ä¸‹ä¸€ä¸ªè·¯å£'}</div>
                        </div>
                    `;
                } else if (index === 10) {
                    stepsHtml += `<div class="route-step more-steps">...</div>`;
                }
            });
            
            return stepsHtml;
        }
        
        // ç”Ÿæˆåˆ†äº«URL
        function generateShareUrl(start, end) {
            const baseUrl = window.location.origin + window.location.pathname;
            return `${baseUrl}?start=${encodeURIComponent(start)}&end=${encodeURIComponent(end)}`;
        }
        
        // é«˜å¾·åœ°å›¾APIåˆå§‹åŒ–å‡½æ•°
        function initAMap() {
            console.log('å¼€å§‹åˆå§‹åŒ–é«˜å¾·åœ°å›¾...');
            
            // æ£€æŸ¥æ˜¯å¦æ­£ç¡®è®¾ç½®äº†å®‰å…¨å¯†é’¥å’ŒAPIå¯†é’¥
            if (!window._AMapSecurityConfig || !window._AMapSecurityConfig.securityJsCode) {
                console.error('æœªè®¾ç½®å®‰å…¨å¯†é’¥ï¼Œå¯èƒ½å¯¼è‡´APIè°ƒç”¨å¤±è´¥');
                // å°è¯•è®¾ç½®å®‰å…¨å¯†é’¥
                window._AMapSecurityConfig = {
                    securityJsCode: '6512b470a154fdfc777257a088527d63'
                };
            }
            
            const mapContainer = document.getElementById('route-planning-map');
            if (!mapContainer) {
                console.error('æœªæ‰¾åˆ°åœ°å›¾å®¹å™¨å…ƒç´ #route-planning-map');
                return;
            }
            
            // æ£€æŸ¥åœ°å›¾å®¹å™¨çš„å°ºå¯¸
            const containerWidth = mapContainer.offsetWidth;
            const containerHeight = mapContainer.offsetHeight;
            console.log(`åœ°å›¾å®¹å™¨å°ºå¯¸: ${containerWidth}x${containerHeight}`);
            
            if (containerWidth === 0 || containerHeight === 0) {
                console.error('åœ°å›¾å®¹å™¨å°ºå¯¸ä¸º0ï¼Œæ— æ³•æ­£ç¡®æ˜¾ç¤ºåœ°å›¾');
                
                // å°è¯•è®¾ç½®æœ€å°é«˜åº¦
                mapContainer.style.minHeight = '400px';
                
                // ç§»é™¤å¯èƒ½å½±å“æ˜¾ç¤ºçš„èƒŒæ™¯å›¾ç‰‡
                mapContainer.style.backgroundImage = 'none';
            }
            
            try {
                // æ£€æŸ¥AMapå¯¹è±¡æ˜¯å¦å­˜åœ¨
                if (!window.AMap) {
                    console.error('AMapä¸å­˜åœ¨ï¼Œå¯èƒ½æ˜¯APIæœªåŠ è½½æˆåŠŸ');
                    mapContainer.innerHTML = `
                        <div style="padding: 20px; text-align: center; color: #666;">
                            <i class="fas fa-exclamation-circle" style="font-size: 32px; color: #ff7e67; margin-bottom: 10px;"></i>
                            <p>åœ°å›¾APIæœªåŠ è½½ï¼Œè¯·åˆ·æ–°é¡µé¢æˆ–æ£€æŸ¥ç½‘ç»œè¿æ¥</p>
                            <p>å¯èƒ½çš„åŸå› ï¼š</p>
                            <ul style="text-align: left; display: inline-block;">
                                <li>åŸŸå ${window.location.hostname} æœªåœ¨é«˜å¾·å¼€æ”¾å¹³å°é…ç½®ç™½åå•</li>
                                <li>APIå¯†é’¥ç±»å‹ä¸æ­£ç¡®ï¼ˆéœ€è¦ä½¿ç”¨Webç«¯JS APIå¯†é’¥ï¼‰</li>
                                <li>å®‰å…¨å¯†é’¥æœªæ­£ç¡®è®¾ç½®</li>
                            </ul>
                        </div>
                    `;
                    return;
                }
                
                // æ£€æŸ¥é”™è¯¯å¯¹è±¡ï¼Œå¯èƒ½åŒ…å«å…·ä½“çš„é”™è¯¯ä¿¡æ¯
                if (window.AMap._errorHandler && window.AMap._errorHandler.message) {
                    const errorMsg = window.AMap._errorHandler.message;
                    console.error('AMapé”™è¯¯:', errorMsg);
                    
                    if (errorMsg.includes('USERKEY_PLAT_NOMATCH') || errorMsg.includes('key')) {
                        mapContainer.innerHTML = `
                            <div style="padding: 20px; text-align: center; color: #666;">
                                <i class="fas fa-exclamation-circle" style="font-size: 32px; color: #ff7e67; margin-bottom: 10px;"></i>
                                <p>APIå¯†é’¥é”™è¯¯: ${errorMsg}</p>
                                <p>è¯·ç¡®ä¿æ‚¨çš„APIå¯†é’¥:</p>
                                <ul style="text-align: left; display: inline-block;">
                                    <li>æ˜¯JS APIå¯†é’¥ï¼ˆéWebæœåŠ¡å¯†é’¥ï¼‰</li>
                                    <li>å·²å°†å½“å‰åŸŸå ${window.location.hostname} æ·»åŠ åˆ°ç™½åå•</li>
                                    <li>å·²æ­£ç¡®è®¾ç½®å®‰å…¨å¯†é’¥</li>
                                </ul>
                            </div>
                        `;
                        return;
                    }
                }
                
                console.log('å¼€å§‹åˆ›å»ºåœ°å›¾å®ä¾‹...');
                
                // åˆ›å»ºåœ°å›¾å®ä¾‹
                window.routeMap = new AMap.Map('route-planning-map', {
                    resizeEnable: true,
                    zoom: 6,
                    center: [104.066801, 30.572961], // æˆéƒ½å¸‚ä¸­å¿ƒåæ ‡
                    mapStyle: 'amap://styles/normal',
                    viewMode: '2D'
                });
                
                console.log('åœ°å›¾å®ä¾‹åˆ›å»ºæˆåŠŸï¼Œæ·»åŠ æ§ä»¶...');
                
                // æ·»åŠ æ§ä»¶
                window.routeMap.plugin(['AMap.ToolBar', 'AMap.Scale', 'AMap.MapType'], function() {
                    window.routeMap.addControl(new AMap.ToolBar({ position: 'RB' }));
                    window.routeMap.addControl(new AMap.Scale());
                    window.routeMap.addControl(new AMap.MapType({ defaultType: 0 }));
                    
                    console.log('åœ°å›¾æ§ä»¶æ·»åŠ æˆåŠŸ');
                });
                
                // åˆå§‹åŒ–é©¾è½¦å¯¼èˆªç»„ä»¶ - ç›´æ¥åˆ›å»ºï¼Œä¸ä½¿ç”¨pluginæ–¹æ³•
                try {
                    window.drivingService = new AMap.Driving({
                        map: window.routeMap,
                        policy: AMap.DrivingPolicy.LEAST_TIME
                    });
                    console.log('é©¾è½¦æœåŠ¡ç›´æ¥åˆå§‹åŒ–æˆåŠŸ');
                } catch (drivingError) {
                    console.error('ç›´æ¥åˆå§‹åŒ–é©¾è½¦æœåŠ¡å¤±è´¥ï¼Œå°è¯•ä½¿ç”¨æ’ä»¶æ–¹å¼:', drivingError);
                    // å°è¯•ä½¿ç”¨æ’ä»¶æ–¹å¼åˆå§‹åŒ–
                    window.routeMap.plugin(['AMap.Driving'], function() {
                        try {
                            window.drivingService = new AMap.Driving({
                                map: window.routeMap,
                                policy: AMap.DrivingPolicy.LEAST_TIME
                            });
                            console.log('é©¾è½¦æœåŠ¡é€šè¿‡æ’ä»¶åˆå§‹åŒ–æˆåŠŸ');
                        } catch (e) {
                            console.error('æ’ä»¶åˆå§‹åŒ–é©¾è½¦æœåŠ¡ä¹Ÿå¤±è´¥:', e);
                        }
                    });
                }
                
                // æ·»åŠ ä¸€ä¸ªæˆéƒ½çš„æ ‡è®°ä½œä¸ºå‚è€ƒç‚¹
                const marker = new AMap.Marker({
                    position: [104.066801, 30.572961],
                    title: 'æˆéƒ½',
                    animation: 'AMAP_ANIMATION_DROP'
                });
                marker.setMap(window.routeMap);
                
                // æ·»åŠ è‡ªåŠ¨å®ŒæˆåŠŸèƒ½
                try {
                    // ç›´æ¥åˆ›å»ºè‡ªåŠ¨å®Œæˆå®ä¾‹
                    const startAutoComplete = new AMap.AutoComplete({
                        input: 'start-point'
                    });
                    
                    const endAutoComplete = new AMap.AutoComplete({
                        input: 'end-point'
                    });
                    
                    console.log('è¾“å…¥æ¡†è‡ªåŠ¨å®ŒæˆåŠŸèƒ½ç›´æ¥åˆå§‹åŒ–æˆåŠŸ');
                } catch (autoCompleteError) {
                    console.error('ç›´æ¥åˆå§‹åŒ–è‡ªåŠ¨å®Œæˆå¤±è´¥ï¼Œå°è¯•ä½¿ç”¨æ’ä»¶æ–¹å¼:', autoCompleteError);
                    
                    // å°è¯•ä½¿ç”¨æ’ä»¶æ–¹å¼åˆå§‹åŒ–
                    window.routeMap.plugin(['AMap.AutoComplete'], function() {
                        try {
                            const startAutoComplete = new AMap.AutoComplete({
                                input: 'start-point'
                            });
                            
                            const endAutoComplete = new AMap.AutoComplete({
                                input: 'end-point'
                            });
                            
                            console.log('è¾“å…¥æ¡†è‡ªåŠ¨å®ŒæˆåŠŸèƒ½é€šè¿‡æ’ä»¶åˆå§‹åŒ–æˆåŠŸ');
                        } catch (e) {
                            console.error('æ’ä»¶åˆå§‹åŒ–è‡ªåŠ¨å®Œæˆä¹Ÿå¤±è´¥:', e);
                        }
                    });
                }
                
                console.log('åœ°å›¾å’Œç›¸å…³æœåŠ¡åˆå§‹åŒ–å®Œæˆ');
            } catch (e) {
                console.error('åœ°å›¾åŠ è½½å¤±è´¥ï¼Œè¯¦ç»†é”™è¯¯:', e);
                // æ˜¾ç¤ºé”™è¯¯æç¤º
                mapContainer.innerHTML = `
                    <div style="padding: 20px; text-align: center; color: #666;">
                        <i class="fas fa-exclamation-circle" style="font-size: 32px; color: #ff7e67; margin-bottom: 10px;"></i>
                        <p>åœ°å›¾åŠ è½½å¤±è´¥: ${e.message}</p>
                        <p>è¯·æ£€æŸ¥APIé…ç½®æˆ–ç¨åå†è¯•</p>
                    </div>
                `;
            }
        }
        
        // åŠ è½½åœ°å›¾API
        function loadMapAPI() {
            console.log('å‡†å¤‡åŠ è½½é«˜å¾·åœ°å›¾API...');
            
            // æ£€æŸ¥åœ°å›¾å®¹å™¨æ˜¯å¦å­˜åœ¨
            const mapContainer = document.getElementById('route-planning-map');
            if (!mapContainer) {
                console.error('æœªæ‰¾åˆ°åœ°å›¾å®¹å™¨å…ƒç´ ');
                return;
            }
            
            // ç§»é™¤å¯èƒ½å½±å“æ˜¾ç¤ºçš„èƒŒæ™¯å›¾ç‰‡
            mapContainer.style.backgroundImage = 'none';
            
            // ä½¿ç”¨Intersection Observerï¼Œå½“åœ°å›¾å®¹å™¨å¯è§æ—¶æ‰åŠ è½½åœ°å›¾
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        console.log('åœ°å›¾å®¹å™¨å¯è§ï¼Œå¼€å§‹åŠ è½½é«˜å¾·åœ°å›¾API');
                        
                        // ç›´æ¥åŠ è½½è„šæœ¬ï¼Œä¸ä½¿ç”¨å·¥å…·å‡½æ•°
                        const script = document.createElement('script');
                        
                        // ä½¿ç”¨å…¨å±€JS APIå¯†é’¥ (Webç«¯)
                        console.log('[åœ°å›¾åŠ è½½]ä½¿ç”¨çš„JS APIå¯†é’¥:', JS_API_KEY);
                        
                        // æ£€æŸ¥å¯†é’¥æ˜¯å¦å·²é…ç½®å®‰å…¨å¯†é’¥
                        if (!window._AMapSecurityConfig || !window._AMapSecurityConfig.securityJsCode) {
                            console.error('æœªè®¾ç½®å®‰å…¨å¯†é’¥ï¼Œè¿™å¯èƒ½å¯¼è‡´APIè°ƒç”¨å¤±è´¥');
                            window._AMapSecurityConfig = {
                                securityJsCode: '6512b470a154fdfc777257a088527d63'
                            };
                        }
                        
                        // ç²¾ç®€æ‰€éœ€æ’ä»¶ï¼Œé¿å…ä¸å¿…è¦çš„åŠ è½½
                        const plugins = [
                            'AMap.Scale',
                            'AMap.ToolBar',
                            'AMap.MapType',
                            'AMap.Driving',
                            'AMap.Geocoder'
                        ].join(',');
                        
                        // æŒ‰ç…§æœ€æ–°çš„JavaScript API v2.0æ–‡æ¡£åŠ è½½åœ°å›¾
                        script.src = `https://webapi.amap.com/maps?v=2.0&key=${JS_API_KEY}&plugin=${plugins}`;
                        script.async = true;
                        
                        script.onload = function() {
                            console.log('é«˜å¾·åœ°å›¾APIåŠ è½½æˆåŠŸ');
                            // åˆå§‹åŒ–åœ°å›¾
                            initAMap();
                        };
                        
                        script.onerror = function(e) {
                            console.error('é«˜å¾·åœ°å›¾APIåŠ è½½å¤±è´¥', e);
                            mapContainer.innerHTML = `
                                <div style="padding: 20px; text-align: center; color: #666;">
                                    <i class="fas fa-exclamation-circle" style="font-size: 32px; color: #ff7e67; margin-bottom: 10px;"></i>
                                    <p>åœ°å›¾APIåŠ è½½å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œè¿æ¥æˆ–åˆ·æ–°é¡µé¢</p>
                                    <p>è¯¦ç»†é”™è¯¯: ${e ? e.toString() : 'æœªçŸ¥é”™è¯¯'}</p>
                                    <p>å¯èƒ½çš„åŸå› : APIå¯†é’¥ä¸åŒ¹é…å½“å‰åŸŸå(${window.location.hostname})</p>
                                </div>
                            `;
                        };
                        
                        document.body.appendChild(script);
                        observer.disconnect();
                    }
                });
            });
            
            observer.observe(mapContainer);
        }
    </script>
</body>
</html> 